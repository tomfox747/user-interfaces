{"ast":null,"code":"/*\n * Chartkick.js\n * Create beautiful charts with one line of JavaScript\n * https://github.com/ankane/chartkick.js\n * v3.2.1\n * MIT License\n */\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() : typeof define === 'function' && define.amd ? define(factory) : (global = global || self, global.Chartkick = factory());\n})(this, function () {\n  'use strict';\n\n  function isArray(variable) {\n    return Object.prototype.toString.call(variable) === \"[object Array]\";\n  }\n\n  function isFunction(variable) {\n    return variable instanceof Function;\n  }\n\n  function isPlainObject(variable) {\n    // protect against prototype pollution, defense 2\n    return Object.prototype.toString.call(variable) === \"[object Object]\" && !isFunction(variable) && variable instanceof Object;\n  } // https://github.com/madrobby/zepto/blob/master/src/zepto.js\n\n\n  function extend(target, source) {\n    var key;\n\n    for (key in source) {\n      // protect against prototype pollution, defense 1\n      if (key === \"__proto__\") {\n        continue;\n      }\n\n      if (isPlainObject(source[key]) || isArray(source[key])) {\n        if (isPlainObject(source[key]) && !isPlainObject(target[key])) {\n          target[key] = {};\n        }\n\n        if (isArray(source[key]) && !isArray(target[key])) {\n          target[key] = [];\n        }\n\n        extend(target[key], source[key]);\n      } else if (source[key] !== undefined) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  function merge(obj1, obj2) {\n    var target = {};\n    extend(target, obj1);\n    extend(target, obj2);\n    return target;\n  }\n\n  var DATE_PATTERN = /^(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)$/i; // https://github.com/Do/iso8601.js\n\n  var ISO8601_PATTERN = /(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)(T)?(\\d\\d)(:)?(\\d\\d)?(:)?(\\d\\d)?([.,]\\d+)?($|Z|([+-])(\\d\\d)(:)?(\\d\\d)?)/i;\n  var DECIMAL_SEPARATOR = String(1.5).charAt(1);\n\n  function parseISO8601(input) {\n    var day, hour, matches, milliseconds, minutes, month, offset, result, seconds, type, year;\n    type = Object.prototype.toString.call(input);\n\n    if (type === \"[object Date]\") {\n      return input;\n    }\n\n    if (type !== \"[object String]\") {\n      return;\n    }\n\n    matches = input.match(ISO8601_PATTERN);\n\n    if (matches) {\n      year = parseInt(matches[1], 10);\n      month = parseInt(matches[3], 10) - 1;\n      day = parseInt(matches[5], 10);\n      hour = parseInt(matches[7], 10);\n      minutes = matches[9] ? parseInt(matches[9], 10) : 0;\n      seconds = matches[11] ? parseInt(matches[11], 10) : 0;\n      milliseconds = matches[12] ? parseFloat(DECIMAL_SEPARATOR + matches[12].slice(1)) * 1000 : 0;\n      result = Date.UTC(year, month, day, hour, minutes, seconds, milliseconds);\n\n      if (matches[13] && matches[14]) {\n        offset = matches[15] * 60;\n\n        if (matches[17]) {\n          offset += parseInt(matches[17], 10);\n        }\n\n        offset *= matches[14] === \"-\" ? -1 : 1;\n        result -= offset * 60 * 1000;\n      }\n\n      return new Date(result);\n    }\n  } // end iso8601.js\n\n\n  function negativeValues(series) {\n    var i, j, data;\n\n    for (i = 0; i < series.length; i++) {\n      data = series[i].data;\n\n      for (j = 0; j < data.length; j++) {\n        if (data[j][1] < 0) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  }\n\n  function toStr(n) {\n    return \"\" + n;\n  }\n\n  function toFloat(n) {\n    return parseFloat(n);\n  }\n\n  function toDate(n) {\n    var matches, year, month, day;\n\n    if (typeof n !== \"object\") {\n      if (typeof n === \"number\") {\n        n = new Date(n * 1000); // ms\n      } else {\n        n = toStr(n);\n\n        if (matches = n.match(DATE_PATTERN)) {\n          year = parseInt(matches[1], 10);\n          month = parseInt(matches[3], 10) - 1;\n          day = parseInt(matches[5], 10);\n          return new Date(year, month, day);\n        } else {\n          // str\n          // try our best to get the str into iso8601\n          // TODO be smarter about this\n          var str = n.replace(/ /, \"T\").replace(\" \", \"\").replace(\"UTC\", \"Z\");\n          n = parseISO8601(str) || new Date(n);\n        }\n      }\n    }\n\n    return n;\n  }\n\n  function toArr(n) {\n    if (!isArray(n)) {\n      var arr = [],\n          i;\n\n      for (i in n) {\n        if (n.hasOwnProperty(i)) {\n          arr.push([i, n[i]]);\n        }\n      }\n\n      n = arr;\n    }\n\n    return n;\n  }\n\n  function jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle) {\n    return function (chart, opts, chartOptions) {\n      var series = chart.data;\n      var options = merge({}, defaultOptions);\n      options = merge(options, chartOptions || {});\n\n      if (chart.hideLegend || \"legend\" in opts) {\n        hideLegend(options, opts.legend, chart.hideLegend);\n      }\n\n      if (opts.title) {\n        setTitle(options, opts.title);\n      } // min\n\n\n      if (\"min\" in opts) {\n        setMin(options, opts.min);\n      } else if (!negativeValues(series)) {\n        setMin(options, 0);\n      } // max\n\n\n      if (opts.max) {\n        setMax(options, opts.max);\n      }\n\n      if (\"stacked\" in opts) {\n        setStacked(options, opts.stacked);\n      }\n\n      if (opts.colors) {\n        options.colors = opts.colors;\n      }\n\n      if (opts.xtitle) {\n        setXtitle(options, opts.xtitle);\n      }\n\n      if (opts.ytitle) {\n        setYtitle(options, opts.ytitle);\n      } // merge library last\n\n\n      options = merge(options, opts.library || {});\n      return options;\n    };\n  }\n\n  function sortByTime(a, b) {\n    return a[0].getTime() - b[0].getTime();\n  }\n\n  function sortByNumberSeries(a, b) {\n    return a[0] - b[0];\n  }\n\n  function sortByNumber(a, b) {\n    return a - b;\n  }\n\n  function isMinute(d) {\n    return d.getMilliseconds() === 0 && d.getSeconds() === 0;\n  }\n\n  function isHour(d) {\n    return isMinute(d) && d.getMinutes() === 0;\n  }\n\n  function isDay(d) {\n    return isHour(d) && d.getHours() === 0;\n  }\n\n  function isWeek(d, dayOfWeek) {\n    return isDay(d) && d.getDay() === dayOfWeek;\n  }\n\n  function isMonth(d) {\n    return isDay(d) && d.getDate() === 1;\n  }\n\n  function isYear(d) {\n    return isMonth(d) && d.getMonth() === 0;\n  }\n\n  function isDate(obj) {\n    return !isNaN(toDate(obj)) && toStr(obj).length >= 6;\n  }\n\n  function isNumber(obj) {\n    return typeof obj === \"number\";\n  }\n\n  var byteSuffixes = [\"bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\"];\n\n  function formatValue(pre, value, options, axis) {\n    pre = pre || \"\";\n\n    if (options.prefix) {\n      if (value < 0) {\n        value = value * -1;\n        pre += \"-\";\n      }\n\n      pre += options.prefix;\n    }\n\n    var suffix = options.suffix || \"\";\n    var precision = options.precision;\n    var round = options.round;\n\n    if (options.byteScale) {\n      var suffixIdx;\n      var baseValue = axis ? options.byteScale : value;\n\n      if (baseValue >= 1152921504606846976) {\n        value /= 1152921504606846976;\n        suffixIdx = 6;\n      } else if (baseValue >= 1125899906842624) {\n        value /= 1125899906842624;\n        suffixIdx = 5;\n      } else if (baseValue >= 1099511627776) {\n        value /= 1099511627776;\n        suffixIdx = 4;\n      } else if (baseValue >= 1073741824) {\n        value /= 1073741824;\n        suffixIdx = 3;\n      } else if (baseValue >= 1048576) {\n        value /= 1048576;\n        suffixIdx = 2;\n      } else if (baseValue >= 1024) {\n        value /= 1024;\n        suffixIdx = 1;\n      } else {\n        suffixIdx = 0;\n      } // TODO handle manual precision case\n\n\n      if (precision === undefined && round === undefined) {\n        if (value >= 1023.5) {\n          if (suffixIdx < byteSuffixes.length - 1) {\n            value = 1.0;\n            suffixIdx += 1;\n          }\n        }\n\n        precision = value >= 1000 ? 4 : 3;\n      }\n\n      suffix = \" \" + byteSuffixes[suffixIdx];\n    }\n\n    if (precision !== undefined && round !== undefined) {\n      throw Error(\"Use either round or precision, not both\");\n    }\n\n    if (!axis) {\n      if (precision !== undefined) {\n        value = value.toPrecision(precision);\n\n        if (!options.zeros) {\n          value = parseFloat(value);\n        }\n      }\n\n      if (round !== undefined) {\n        if (round < 0) {\n          var num = Math.pow(10, -1 * round);\n          value = parseInt((1.0 * value / num).toFixed(0)) * num;\n        } else {\n          value = value.toFixed(round);\n\n          if (!options.zeros) {\n            value = parseFloat(value);\n          }\n        }\n      }\n    }\n\n    if (options.thousands || options.decimal) {\n      value = toStr(value);\n      var parts = value.split(\".\");\n      value = parts[0];\n\n      if (options.thousands) {\n        value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, options.thousands);\n      }\n\n      if (parts.length > 1) {\n        value += (options.decimal || \".\") + parts[1];\n      }\n    }\n\n    return pre + value + suffix;\n  }\n\n  function seriesOption(chart, series, option) {\n    if (option in series) {\n      return series[option];\n    } else if (option in chart.options) {\n      return chart.options[option];\n    }\n\n    return null;\n  }\n\n  function allZeros(data) {\n    var i, j, d;\n\n    for (i = 0; i < data.length; i++) {\n      d = data[i].data;\n\n      for (j = 0; j < d.length; j++) {\n        if (d[j][1] != 0) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  }\n\n  var baseOptions = {\n    maintainAspectRatio: false,\n    animation: false,\n    tooltips: {\n      displayColors: false,\n      callbacks: {}\n    },\n    legend: {},\n    title: {\n      fontSize: 20,\n      fontColor: \"#333\"\n    }\n  };\n  var defaultOptions = {\n    scales: {\n      yAxes: [{\n        ticks: {\n          maxTicksLimit: 4\n        },\n        scaleLabel: {\n          fontSize: 16,\n          // fontStyle: \"bold\",\n          fontColor: \"#333\"\n        }\n      }],\n      xAxes: [{\n        gridLines: {\n          drawOnChartArea: false\n        },\n        scaleLabel: {\n          fontSize: 16,\n          // fontStyle: \"bold\",\n          fontColor: \"#333\"\n        },\n        time: {},\n        ticks: {}\n      }]\n    }\n  }; // http://there4.io/2012/05/02/google-chart-color-list/\n\n  var defaultColors = [\"#3366CC\", \"#DC3912\", \"#FF9900\", \"#109618\", \"#990099\", \"#3B3EAC\", \"#0099C6\", \"#DD4477\", \"#66AA00\", \"#B82E2E\", \"#316395\", \"#994499\", \"#22AA99\", \"#AAAA11\", \"#6633CC\", \"#E67300\", \"#8B0707\", \"#329262\", \"#5574A6\", \"#651067\"];\n\n  var hideLegend = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.display = !!legend;\n\n      if (legend && legend !== true) {\n        options.legend.position = legend;\n      }\n    } else if (hideLegend) {\n      options.legend.display = false;\n    }\n  };\n\n  var setTitle = function (options, title) {\n    options.title.display = true;\n    options.title.text = title;\n  };\n\n  var setMin = function (options, min) {\n    if (min !== null) {\n      options.scales.yAxes[0].ticks.min = toFloat(min);\n    }\n  };\n\n  var setMax = function (options, max) {\n    options.scales.yAxes[0].ticks.max = toFloat(max);\n  };\n\n  var setBarMin = function (options, min) {\n    if (min !== null) {\n      options.scales.xAxes[0].ticks.min = toFloat(min);\n    }\n  };\n\n  var setBarMax = function (options, max) {\n    options.scales.xAxes[0].ticks.max = toFloat(max);\n  };\n\n  var setStacked = function (options, stacked) {\n    options.scales.xAxes[0].stacked = !!stacked;\n    options.scales.yAxes[0].stacked = !!stacked;\n  };\n\n  var setXtitle = function (options, title) {\n    options.scales.xAxes[0].scaleLabel.display = true;\n    options.scales.xAxes[0].scaleLabel.labelString = title;\n  };\n\n  var setYtitle = function (options, title) {\n    options.scales.yAxes[0].scaleLabel.display = true;\n    options.scales.yAxes[0].scaleLabel.labelString = title;\n  }; // https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n\n\n  var addOpacity = function (hex, opacity) {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? \"rgba(\" + parseInt(result[1], 16) + \", \" + parseInt(result[2], 16) + \", \" + parseInt(result[3], 16) + \", \" + opacity + \")\" : hex;\n  }; // check if not null or undefined\n  // https://stackoverflow.com/a/27757708/1177228\n\n\n  var notnull = function (x) {\n    return x != null;\n  };\n\n  var setLabelSize = function (chart, data, options) {\n    var maxLabelSize = Math.ceil(chart.element.offsetWidth / 4.0 / data.labels.length);\n\n    if (maxLabelSize > 25) {\n      maxLabelSize = 25;\n    } else if (maxLabelSize < 10) {\n      maxLabelSize = 10;\n    }\n\n    if (!options.scales.xAxes[0].ticks.callback) {\n      options.scales.xAxes[0].ticks.callback = function (value) {\n        value = toStr(value);\n\n        if (value.length > maxLabelSize) {\n          return value.substring(0, maxLabelSize - 2) + \"...\";\n        } else {\n          return value;\n        }\n      };\n    }\n  };\n\n  var setFormatOptions = function (chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chart.options.bytes) {\n      var series = chart.data;\n\n      if (chartType === \"pie\") {\n        series = [{\n          data: series\n        }];\n      } // calculate max\n\n\n      var max = 0;\n\n      for (var i = 0; i < series.length; i++) {\n        var s = series[i];\n\n        for (var j = 0; j < s.data.length; j++) {\n          if (s.data[j][1] > max) {\n            max = s.data[j][1];\n          }\n        }\n      } // calculate scale\n\n\n      var scale = 1;\n\n      while (max >= 1024) {\n        scale *= 1024;\n        max /= 1024;\n      } // set step size\n\n\n      formatOptions.byteScale = scale;\n    }\n\n    if (chartType !== \"pie\") {\n      var myAxes = options.scales.yAxes;\n\n      if (chartType === \"bar\") {\n        myAxes = options.scales.xAxes;\n      }\n\n      if (formatOptions.byteScale) {\n        if (!myAxes[0].ticks.stepSize) {\n          myAxes[0].ticks.stepSize = formatOptions.byteScale / 2;\n        }\n\n        if (!myAxes[0].ticks.maxTicksLimit) {\n          myAxes[0].ticks.maxTicksLimit = 4;\n        }\n      }\n\n      if (!myAxes[0].ticks.callback) {\n        myAxes[0].ticks.callback = function (value) {\n          return formatValue(\"\", value, formatOptions, true);\n        };\n      }\n    }\n\n    if (!options.tooltips.callbacks.label) {\n      if (chartType === \"scatter\") {\n        options.tooltips.callbacks.label = function (item, data) {\n          var label = data.datasets[item.datasetIndex].label || '';\n\n          if (label) {\n            label += ': ';\n          }\n\n          return label + '(' + item.xLabel + ', ' + item.yLabel + ')';\n        };\n      } else if (chartType === \"bubble\") {\n        options.tooltips.callbacks.label = function (item, data) {\n          var label = data.datasets[item.datasetIndex].label || '';\n\n          if (label) {\n            label += ': ';\n          }\n\n          var dataPoint = data.datasets[item.datasetIndex].data[item.index];\n          return label + '(' + item.xLabel + ', ' + item.yLabel + ', ' + dataPoint.v + ')';\n        };\n      } else if (chartType === \"pie\") {\n        // need to use separate label for pie charts\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          var dataLabel = data.labels[tooltipItem.index];\n          var value = ': ';\n\n          if (isArray(dataLabel)) {\n            // show value on first line of multiline label\n            // need to clone because we are changing the value\n            dataLabel = dataLabel.slice();\n            dataLabel[0] += value;\n          } else {\n            dataLabel += value;\n          }\n\n          return formatValue(dataLabel, data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index], formatOptions);\n        };\n      } else {\n        var valueLabel = chartType === \"bar\" ? \"xLabel\" : \"yLabel\";\n\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          var label = data.datasets[tooltipItem.datasetIndex].label || '';\n\n          if (label) {\n            label += ': ';\n          }\n\n          return formatValue(label, tooltipItem[valueLabel], formatOptions);\n        };\n      }\n    }\n  };\n\n  var jsOptions = jsOptionsFunc(merge(baseOptions, defaultOptions), hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle);\n\n  var createDataTable = function (chart, options, chartType, library) {\n    var datasets = [];\n    var labels = [];\n    var colors = chart.options.colors || defaultColors;\n    var day = true;\n    var week = true;\n    var dayOfWeek;\n    var month = true;\n    var year = true;\n    var hour = true;\n    var minute = true;\n    var series = chart.data;\n    var max = 0;\n\n    if (chartType === \"bubble\") {\n      for (var i$1 = 0; i$1 < series.length; i$1++) {\n        var s$1 = series[i$1];\n\n        for (var j$1 = 0; j$1 < s$1.data.length; j$1++) {\n          if (s$1.data[j$1][2] > max) {\n            max = s$1.data[j$1][2];\n          }\n        }\n      }\n    }\n\n    var i,\n        j,\n        s,\n        d,\n        key,\n        rows = [],\n        rows2 = [];\n\n    if (chartType === \"bar\" || chartType === \"column\" || chart.xtype !== \"number\" && chart.xtype !== \"bubble\") {\n      var sortedLabels = [];\n\n      for (i = 0; i < series.length; i++) {\n        s = series[i];\n\n        for (j = 0; j < s.data.length; j++) {\n          d = s.data[j];\n          key = chart.xtype == \"datetime\" ? d[0].getTime() : d[0];\n\n          if (!rows[key]) {\n            rows[key] = new Array(series.length);\n          }\n\n          rows[key][i] = toFloat(d[1]);\n\n          if (sortedLabels.indexOf(key) === -1) {\n            sortedLabels.push(key);\n          }\n        }\n      }\n\n      if (chart.xtype === \"datetime\" || chart.xtype === \"number\") {\n        sortedLabels.sort(sortByNumber);\n      }\n\n      for (j = 0; j < series.length; j++) {\n        rows2.push([]);\n      }\n\n      var value;\n      var k;\n\n      for (k = 0; k < sortedLabels.length; k++) {\n        i = sortedLabels[k];\n\n        if (chart.xtype === \"datetime\") {\n          value = new Date(toFloat(i)); // TODO make this efficient\n\n          day = day && isDay(value);\n\n          if (!dayOfWeek) {\n            dayOfWeek = value.getDay();\n          }\n\n          week = week && isWeek(value, dayOfWeek);\n          month = month && isMonth(value);\n          year = year && isYear(value);\n          hour = hour && isHour(value);\n          minute = minute && isMinute(value);\n        } else {\n          value = i;\n        }\n\n        labels.push(value);\n\n        for (j = 0; j < series.length; j++) {\n          // Chart.js doesn't like undefined\n          rows2[j].push(rows[i][j] === undefined ? null : rows[i][j]);\n        }\n      }\n    } else {\n      for (var i$2 = 0; i$2 < series.length; i$2++) {\n        var s$2 = series[i$2];\n        var d$1 = [];\n\n        for (var j$2 = 0; j$2 < s$2.data.length; j$2++) {\n          var point = {\n            x: toFloat(s$2.data[j$2][0]),\n            y: toFloat(s$2.data[j$2][1])\n          };\n\n          if (chartType === \"bubble\") {\n            point.r = toFloat(s$2.data[j$2][2]) * 20 / max; // custom attribute, for tooltip\n\n            point.v = s$2.data[j$2][2];\n          }\n\n          d$1.push(point);\n        }\n\n        rows2.push(d$1);\n      }\n    }\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n      var color = s.color || colors[i];\n      var backgroundColor = chartType !== \"line\" ? addOpacity(color, 0.5) : color;\n      var dataset = {\n        label: s.name || \"\",\n        data: rows2[i],\n        fill: chartType === \"area\",\n        borderColor: color,\n        backgroundColor: backgroundColor,\n        pointBackgroundColor: color,\n        borderWidth: 2,\n        pointHoverBackgroundColor: color\n      };\n\n      if (s.stack) {\n        dataset.stack = s.stack;\n      }\n\n      var curve = seriesOption(chart, s, \"curve\");\n\n      if (curve === false) {\n        dataset.lineTension = 0;\n      }\n\n      var points = seriesOption(chart, s, \"points\");\n\n      if (points === false) {\n        dataset.pointRadius = 0;\n        dataset.pointHitRadius = 5;\n      }\n\n      dataset = merge(dataset, chart.options.dataset || {});\n      dataset = merge(dataset, s.library || {});\n      dataset = merge(dataset, s.dataset || {});\n      datasets.push(dataset);\n    }\n\n    var xmin = chart.options.xmin;\n    var xmax = chart.options.xmax;\n\n    if (chart.xtype === \"datetime\") {\n      // hacky check for Chart.js >= 2.9.0\n      // https://github.com/chartjs/Chart.js/compare/v2.8.0...v2.9.0\n      var gte29 = (\"math\" in library.helpers);\n      var ticksKey = gte29 ? \"ticks\" : \"time\";\n\n      if (notnull(xmin)) {\n        options.scales.xAxes[0][ticksKey].min = toDate(xmin).getTime();\n      }\n\n      if (notnull(xmax)) {\n        options.scales.xAxes[0][ticksKey].max = toDate(xmax).getTime();\n      }\n    } else if (chart.xtype === \"number\") {\n      if (notnull(xmin)) {\n        options.scales.xAxes[0].ticks.min = xmin;\n      }\n\n      if (notnull(xmax)) {\n        options.scales.xAxes[0].ticks.max = xmax;\n      }\n    } // for empty datetime chart\n\n\n    if (chart.xtype === \"datetime\" && labels.length === 0) {\n      if (notnull(xmin)) {\n        labels.push(toDate(xmin));\n      }\n\n      if (notnull(xmax)) {\n        labels.push(toDate(xmax));\n      }\n\n      day = false;\n      week = false;\n      month = false;\n      year = false;\n      hour = false;\n      minute = false;\n    }\n\n    if (chart.xtype === \"datetime\" && labels.length > 0) {\n      var minTime = (notnull(xmin) ? toDate(xmin) : labels[0]).getTime();\n      var maxTime = (notnull(xmax) ? toDate(xmax) : labels[0]).getTime();\n\n      for (i = 1; i < labels.length; i++) {\n        var value$1 = labels[i].getTime();\n\n        if (value$1 < minTime) {\n          minTime = value$1;\n        }\n\n        if (value$1 > maxTime) {\n          maxTime = value$1;\n        }\n      }\n\n      var timeDiff = (maxTime - minTime) / (86400 * 1000.0);\n\n      if (!options.scales.xAxes[0].time.unit) {\n        var step;\n\n        if (year || timeDiff > 365 * 10) {\n          options.scales.xAxes[0].time.unit = \"year\";\n          step = 365;\n        } else if (month || timeDiff > 30 * 10) {\n          options.scales.xAxes[0].time.unit = \"month\";\n          step = 30;\n        } else if (day || timeDiff > 10) {\n          options.scales.xAxes[0].time.unit = \"day\";\n          step = 1;\n        } else if (hour || timeDiff > 0.5) {\n          options.scales.xAxes[0].time.displayFormats = {\n            hour: \"MMM D, h a\"\n          };\n          options.scales.xAxes[0].time.unit = \"hour\";\n          step = 1 / 24.0;\n        } else if (minute) {\n          options.scales.xAxes[0].time.displayFormats = {\n            minute: \"h:mm a\"\n          };\n          options.scales.xAxes[0].time.unit = \"minute\";\n          step = 1 / 24.0 / 60.0;\n        }\n\n        if (step && timeDiff > 0) {\n          var unitStepSize = Math.ceil(timeDiff / step / (chart.element.offsetWidth / 100.0));\n\n          if (week && step === 1) {\n            unitStepSize = Math.ceil(unitStepSize / 7.0) * 7;\n          }\n\n          options.scales.xAxes[0].time.unitStepSize = unitStepSize;\n        }\n      }\n\n      if (!options.scales.xAxes[0].time.tooltipFormat) {\n        if (day) {\n          options.scales.xAxes[0].time.tooltipFormat = \"ll\";\n        } else if (hour) {\n          options.scales.xAxes[0].time.tooltipFormat = \"MMM D, h a\";\n        } else if (minute) {\n          options.scales.xAxes[0].time.tooltipFormat = \"h:mm a\";\n        }\n      }\n    }\n\n    var data = {\n      labels: labels,\n      datasets: datasets\n    };\n    return data;\n  };\n\n  var defaultExport = function defaultExport(library) {\n    this.name = \"chartjs\";\n    this.library = library;\n  };\n\n  defaultExport.prototype.renderLineChart = function renderLineChart(chart, chartType) {\n    var chartOptions = {}; // fix for https://github.com/chartjs/Chart.js/issues/2441\n\n    if (!chart.options.max && allZeros(chart.data)) {\n      chartOptions.max = 1;\n    }\n\n    var options = jsOptions(chart, merge(chartOptions, chart.options));\n    setFormatOptions(chart, options, chartType);\n    var data = createDataTable(chart, options, chartType || \"line\", this.library);\n\n    if (chart.xtype === \"number\") {\n      options.scales.xAxes[0].type = \"linear\";\n      options.scales.xAxes[0].position = \"bottom\";\n    } else {\n      options.scales.xAxes[0].type = chart.xtype === \"string\" ? \"category\" : \"time\";\n    }\n\n    this.drawChart(chart, \"line\", data, options);\n  };\n\n  defaultExport.prototype.renderPieChart = function renderPieChart(chart) {\n    var options = merge({}, baseOptions);\n\n    if (chart.options.donut) {\n      options.cutoutPercentage = 50;\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend(options, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle(options, chart.options.title);\n    }\n\n    options = merge(options, chart.options.library || {});\n    setFormatOptions(chart, options, \"pie\");\n    var labels = [];\n    var values = [];\n\n    for (var i = 0; i < chart.data.length; i++) {\n      var point = chart.data[i];\n      labels.push(point[0]);\n      values.push(point[1]);\n    }\n\n    var dataset = {\n      data: values,\n      backgroundColor: chart.options.colors || defaultColors\n    };\n    dataset = merge(dataset, chart.options.dataset || {});\n    var data = {\n      labels: labels,\n      datasets: [dataset]\n    };\n    this.drawChart(chart, \"pie\", data, options);\n  };\n\n  defaultExport.prototype.renderColumnChart = function renderColumnChart(chart, chartType) {\n    var options;\n\n    if (chartType === \"bar\") {\n      var barOptions = merge(baseOptions, defaultOptions);\n      delete barOptions.scales.yAxes[0].ticks.maxTicksLimit;\n      options = jsOptionsFunc(barOptions, hideLegend, setTitle, setBarMin, setBarMax, setStacked, setXtitle, setYtitle)(chart, chart.options);\n    } else {\n      options = jsOptions(chart, chart.options);\n    }\n\n    setFormatOptions(chart, options, chartType);\n    var data = createDataTable(chart, options, \"column\", this.library);\n\n    if (chartType !== \"bar\") {\n      setLabelSize(chart, data, options);\n    }\n\n    this.drawChart(chart, chartType === \"bar\" ? \"horizontalBar\" : \"bar\", data, options);\n  };\n\n  defaultExport.prototype.renderAreaChart = function renderAreaChart(chart) {\n    this.renderLineChart(chart, \"area\");\n  };\n\n  defaultExport.prototype.renderBarChart = function renderBarChart(chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport.prototype.renderScatterChart = function renderScatterChart(chart, chartType) {\n    chartType = chartType || \"scatter\";\n    var options = jsOptions(chart, chart.options);\n    setFormatOptions(chart, options, chartType);\n\n    if (!(\"showLines\" in options)) {\n      options.showLines = false;\n    }\n\n    var data = createDataTable(chart, options, chartType, this.library);\n    options.scales.xAxes[0].type = \"linear\";\n    options.scales.xAxes[0].position = \"bottom\";\n    this.drawChart(chart, chartType, data, options);\n  };\n\n  defaultExport.prototype.renderBubbleChart = function renderBubbleChart(chart) {\n    this.renderScatterChart(chart, \"bubble\");\n  };\n\n  defaultExport.prototype.destroy = function destroy(chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport.prototype.drawChart = function drawChart(chart, type, data, options) {\n    this.destroy(chart);\n    var chartOptions = {\n      type: type,\n      data: data,\n      options: options\n    };\n\n    if (chart.options.code) {\n      window.console.log(\"new Chart(ctx, \" + JSON.stringify(chartOptions) + \");\");\n    }\n\n    chart.element.innerHTML = \"<canvas></canvas>\";\n    var ctx = chart.element.getElementsByTagName(\"CANVAS\")[0];\n    chart.chart = new this.library(ctx, chartOptions);\n  };\n\n  var defaultOptions$1 = {\n    chart: {},\n    xAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    yAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    title: {\n      text: null\n    },\n    credits: {\n      enabled: false\n    },\n    legend: {\n      borderWidth: 0\n    },\n    tooltip: {\n      style: {\n        fontSize: \"12px\"\n      }\n    },\n    plotOptions: {\n      areaspline: {},\n      area: {},\n      series: {\n        marker: {}\n      }\n    }\n  };\n\n  var hideLegend$1 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.enabled = !!legend;\n\n      if (legend && legend !== true) {\n        if (legend === \"top\" || legend === \"bottom\") {\n          options.legend.verticalAlign = legend;\n        } else {\n          options.legend.layout = \"vertical\";\n          options.legend.verticalAlign = \"middle\";\n          options.legend.align = legend;\n        }\n      }\n    } else if (hideLegend) {\n      options.legend.enabled = false;\n    }\n  };\n\n  var setTitle$1 = function (options, title) {\n    options.title.text = title;\n  };\n\n  var setMin$1 = function (options, min) {\n    options.yAxis.min = min;\n  };\n\n  var setMax$1 = function (options, max) {\n    options.yAxis.max = max;\n  };\n\n  var setStacked$1 = function (options, stacked) {\n    var stackedValue = stacked ? stacked === true ? \"normal\" : stacked : null;\n    options.plotOptions.series.stacking = stackedValue;\n    options.plotOptions.area.stacking = stackedValue;\n    options.plotOptions.areaspline.stacking = stackedValue;\n  };\n\n  var setXtitle$1 = function (options, title) {\n    options.xAxis.title.text = title;\n  };\n\n  var setYtitle$1 = function (options, title) {\n    options.yAxis.title.text = title;\n  };\n\n  var jsOptions$1 = jsOptionsFunc(defaultOptions$1, hideLegend$1, setTitle$1, setMin$1, setMax$1, setStacked$1, setXtitle$1, setYtitle$1);\n\n  var setFormatOptions$1 = function (chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chartType !== \"pie\" && !options.yAxis.labels.formatter) {\n      options.yAxis.labels.formatter = function () {\n        return formatValue(\"\", this.value, formatOptions);\n      };\n    }\n\n    if (!options.tooltip.pointFormatter) {\n      options.tooltip.pointFormatter = function () {\n        return '<span style=\"color:' + this.color + '\">\\u25CF</span> ' + formatValue(this.series.name + ': <b>', this.y, formatOptions) + '</b><br/>';\n      };\n    }\n  };\n\n  var defaultExport$1 = function defaultExport(library) {\n    this.name = \"highcharts\";\n    this.library = library;\n  };\n\n  defaultExport$1.prototype.renderLineChart = function renderLineChart(chart, chartType) {\n    chartType = chartType || \"spline\";\n    var chartOptions = {};\n\n    if (chartType === \"areaspline\") {\n      chartOptions = {\n        plotOptions: {\n          areaspline: {\n            stacking: \"normal\"\n          },\n          area: {\n            stacking: \"normal\"\n          },\n          series: {\n            marker: {\n              enabled: false\n            }\n          }\n        }\n      };\n    }\n\n    if (chart.options.curve === false) {\n      if (chartType === \"areaspline\") {\n        chartType = \"area\";\n      } else if (chartType === \"spline\") {\n        chartType = \"line\";\n      }\n    }\n\n    var options = jsOptions$1(chart, chart.options, chartOptions),\n        data,\n        i,\n        j;\n    options.xAxis.type = chart.xtype === \"string\" ? \"category\" : chart.xtype === \"number\" ? \"linear\" : \"datetime\";\n\n    if (!options.chart.type) {\n      options.chart.type = chartType;\n    }\n\n    setFormatOptions$1(chart, options, chartType);\n    var series = chart.data;\n\n    for (i = 0; i < series.length; i++) {\n      series[i].name = series[i].name || \"Value\";\n      data = series[i].data;\n\n      if (chart.xtype === \"datetime\") {\n        for (j = 0; j < data.length; j++) {\n          data[j][0] = data[j][0].getTime();\n        }\n      }\n\n      series[i].marker = {\n        symbol: \"circle\"\n      };\n\n      if (chart.options.points === false) {\n        series[i].marker.enabled = false;\n      }\n    }\n\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderScatterChart = function renderScatterChart(chart) {\n    var options = jsOptions$1(chart, chart.options, {});\n    options.chart.type = \"scatter\";\n    this.drawChart(chart, chart.data, options);\n  };\n\n  defaultExport$1.prototype.renderPieChart = function renderPieChart(chart) {\n    var chartOptions = merge(defaultOptions$1, {});\n\n    if (chart.options.colors) {\n      chartOptions.colors = chart.options.colors;\n    }\n\n    if (chart.options.donut) {\n      chartOptions.plotOptions = {\n        pie: {\n          innerSize: \"50%\"\n        }\n      };\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend$1(chartOptions, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle$1(chartOptions, chart.options.title);\n    }\n\n    var options = merge(chartOptions, chart.options.library || {});\n    setFormatOptions$1(chart, options, \"pie\");\n    var series = [{\n      type: \"pie\",\n      name: chart.options.label || \"Value\",\n      data: chart.data\n    }];\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderColumnChart = function renderColumnChart(chart, chartType) {\n    chartType = chartType || \"column\";\n    var series = chart.data;\n    var options = jsOptions$1(chart, chart.options),\n        i,\n        j,\n        s,\n        d,\n        rows = [],\n        categories = [];\n    options.chart.type = chartType;\n    setFormatOptions$1(chart, options, chartType);\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n\n        if (!rows[d[0]]) {\n          rows[d[0]] = new Array(series.length);\n          categories.push(d[0]);\n        }\n\n        rows[d[0]][i] = d[1];\n      }\n    }\n\n    if (chart.xtype === \"number\") {\n      categories.sort(sortByNumber);\n    }\n\n    options.xAxis.categories = categories;\n    var newSeries = [],\n        d2;\n\n    for (i = 0; i < series.length; i++) {\n      d = [];\n\n      for (j = 0; j < categories.length; j++) {\n        d.push(rows[categories[j]][i] || 0);\n      }\n\n      d2 = {\n        name: series[i].name || \"Value\",\n        data: d\n      };\n\n      if (series[i].stack) {\n        d2.stack = series[i].stack;\n      }\n\n      newSeries.push(d2);\n    }\n\n    this.drawChart(chart, newSeries, options);\n  };\n\n  defaultExport$1.prototype.renderBarChart = function renderBarChart(chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport$1.prototype.renderAreaChart = function renderAreaChart(chart) {\n    this.renderLineChart(chart, \"areaspline\");\n  };\n\n  defaultExport$1.prototype.destroy = function destroy(chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport$1.prototype.drawChart = function drawChart(chart, data, options) {\n    this.destroy(chart);\n    options.chart.renderTo = chart.element.id;\n    options.series = data;\n\n    if (chart.options.code) {\n      window.console.log(\"new Highcharts.Chart(\" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.Chart(options);\n  };\n\n  var loaded = {};\n  var callbacks = []; // Set chart options\n\n  var defaultOptions$2 = {\n    chartArea: {},\n    fontName: \"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif\",\n    pointSize: 6,\n    legend: {\n      textStyle: {\n        fontSize: 12,\n        color: \"#444\"\n      },\n      alignment: \"center\",\n      position: \"right\"\n    },\n    curveType: \"function\",\n    hAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      gridlines: {\n        color: \"transparent\"\n      },\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    vAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    tooltip: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      }\n    }\n  };\n\n  var hideLegend$2 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      var position;\n\n      if (!legend) {\n        position = \"none\";\n      } else if (legend === true) {\n        position = \"right\";\n      } else {\n        position = legend;\n      }\n\n      options.legend.position = position;\n    } else if (hideLegend) {\n      options.legend.position = \"none\";\n    }\n  };\n\n  var setTitle$2 = function (options, title) {\n    options.title = title;\n    options.titleTextStyle = {\n      color: \"#333\",\n      fontSize: \"20px\"\n    };\n  };\n\n  var setMin$2 = function (options, min) {\n    options.vAxis.viewWindow.min = min;\n  };\n\n  var setMax$2 = function (options, max) {\n    options.vAxis.viewWindow.max = max;\n  };\n\n  var setBarMin$1 = function (options, min) {\n    options.hAxis.viewWindow.min = min;\n  };\n\n  var setBarMax$1 = function (options, max) {\n    options.hAxis.viewWindow.max = max;\n  };\n\n  var setStacked$2 = function (options, stacked) {\n    options.isStacked = stacked ? stacked : false;\n  };\n\n  var setXtitle$2 = function (options, title) {\n    options.hAxis.title = title;\n    options.hAxis.titleTextStyle.italic = false;\n  };\n\n  var setYtitle$2 = function (options, title) {\n    options.vAxis.title = title;\n    options.vAxis.titleTextStyle.italic = false;\n  };\n\n  var jsOptions$2 = jsOptionsFunc(defaultOptions$2, hideLegend$2, setTitle$2, setMin$2, setMax$2, setStacked$2, setXtitle$2, setYtitle$2);\n\n  var resize = function (callback) {\n    if (window.attachEvent) {\n      window.attachEvent(\"onresize\", callback);\n    } else if (window.addEventListener) {\n      window.addEventListener(\"resize\", callback, true);\n    }\n\n    callback();\n  };\n\n  var defaultExport$2 = function defaultExport(library) {\n    this.name = \"google\";\n    this.library = library;\n  };\n\n  defaultExport$2.prototype.renderLineChart = function renderLineChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n\n      if (chart.options.curve === false) {\n        chartOptions.curveType = \"none\";\n      }\n\n      if (chart.options.points === false) {\n        chartOptions.pointSize = 0;\n      }\n\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"LineChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderPieChart = function renderPieChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        chartArea: {\n          top: \"10%\",\n          height: \"80%\"\n        },\n        legend: {}\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n\n      if (chart.options.donut) {\n        chartOptions.pieHole = 0.5;\n      }\n\n      if (\"legend\" in chart.options) {\n        hideLegend$2(chartOptions, chart.options.legend);\n      }\n\n      if (chart.options.title) {\n        setTitle$2(chartOptions, chart.options.title);\n      }\n\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", \"Value\");\n      data.addRows(chart.data);\n      this$1.drawChart(chart, \"PieChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderColumnChart = function renderColumnChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var options = jsOptions$2(chart, chart.options);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"ColumnChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderBarChart = function renderBarChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        hAxis: {\n          gridlines: {\n            color: \"#ccc\"\n          }\n        }\n      };\n      var options = jsOptionsFunc(defaultOptions$2, hideLegend$2, setTitle$2, setBarMin$1, setBarMax$1, setStacked$2, setXtitle$2, setYtitle$2)(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"BarChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderAreaChart = function renderAreaChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        isStacked: true,\n        pointSize: 0,\n        areaOpacity: 0.5\n      };\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n      this$1.drawChart(chart, \"AreaChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderGeoChart = function renderGeoChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, \"geochart\", function () {\n      var chartOptions = {\n        legend: \"none\",\n        colorAxis: {\n          colors: chart.options.colors || [\"#f6c7b6\", \"#ce502d\"]\n        }\n      };\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", chart.options.label || \"Value\");\n      data.addRows(chart.data);\n      this$1.drawChart(chart, \"GeoChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderScatterChart = function renderScatterChart(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var series = chart.data,\n          rows2 = [],\n          i,\n          j,\n          data,\n          d;\n\n      for (i = 0; i < series.length; i++) {\n        series[i].name = series[i].name || \"Value\";\n        d = series[i].data;\n\n        for (j = 0; j < d.length; j++) {\n          var row = new Array(series.length + 1);\n          row[0] = d[j][0];\n          row[i + 1] = d[j][1];\n          rows2.push(row);\n        }\n      }\n\n      data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"number\", \"\");\n\n      for (i = 0; i < series.length; i++) {\n        data.addColumn(\"number\", series[i].name);\n      }\n\n      data.addRows(rows2);\n      this$1.drawChart(chart, \"ScatterChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderTimeline = function renderTimeline(chart) {\n    var this$1 = this;\n    this.waitForLoaded(chart, \"timeline\", function () {\n      var chartOptions = {\n        legend: \"none\"\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn({\n        type: \"string\",\n        id: \"Name\"\n      });\n      data.addColumn({\n        type: \"date\",\n        id: \"Start\"\n      });\n      data.addColumn({\n        type: \"date\",\n        id: \"End\"\n      });\n      data.addRows(chart.data);\n      chart.element.style.lineHeight = \"normal\";\n      this$1.drawChart(chart, \"Timeline\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.destroy = function destroy(chart) {\n    if (chart.chart) {\n      chart.chart.clearChart();\n    }\n  };\n\n  defaultExport$2.prototype.drawChart = function drawChart(chart, type, data, options) {\n    this.destroy(chart);\n\n    if (chart.options.code) {\n      window.console.log(\"var data = new google.visualization.DataTable(\" + data.toJSON() + \");\\nvar chart = new google.visualization.\" + type + \"(element);\\nchart.draw(data, \" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.visualization[type](chart.element);\n    resize(function () {\n      chart.chart.draw(data, options);\n    });\n  };\n\n  defaultExport$2.prototype.waitForLoaded = function waitForLoaded(chart, pack, callback) {\n    var this$1 = this;\n\n    if (!callback) {\n      callback = pack;\n      pack = \"corechart\";\n    }\n\n    callbacks.push({\n      pack: pack,\n      callback: callback\n    });\n\n    if (loaded[pack]) {\n      this.runCallbacks();\n    } else {\n      loaded[pack] = true; // https://groups.google.com/forum/#!topic/google-visualization-api/fMKJcyA2yyI\n\n      var loadOptions = {\n        packages: [pack],\n        callback: function () {\n          this$1.runCallbacks();\n        }\n      };\n\n      var config = chart.__config();\n\n      if (config.language) {\n        loadOptions.language = config.language;\n      }\n\n      if (pack === \"geochart\" && config.mapsApiKey) {\n        loadOptions.mapsApiKey = config.mapsApiKey;\n      }\n\n      this.library.charts.load(\"current\", loadOptions);\n    }\n  };\n\n  defaultExport$2.prototype.runCallbacks = function runCallbacks() {\n    var cb, call;\n\n    for (var i = 0; i < callbacks.length; i++) {\n      cb = callbacks[i];\n      call = this.library.visualization && (cb.pack === \"corechart\" && this.library.visualization.LineChart || cb.pack === \"timeline\" && this.library.visualization.Timeline || cb.pack === \"geochart\" && this.library.visualization.GeoChart);\n\n      if (call) {\n        cb.callback();\n        callbacks.splice(i, 1);\n        i--;\n      }\n    }\n  }; // cant use object as key\n\n\n  defaultExport$2.prototype.createDataTable = function createDataTable(series, columnType) {\n    var i,\n        j,\n        s,\n        d,\n        key,\n        rows = [],\n        sortedLabels = [];\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n      series[i].name = series[i].name || \"Value\";\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        key = columnType === \"datetime\" ? d[0].getTime() : d[0];\n\n        if (!rows[key]) {\n          rows[key] = new Array(series.length);\n          sortedLabels.push(key);\n        }\n\n        rows[key][i] = toFloat(d[1]);\n      }\n    }\n\n    var rows2 = [];\n    var day = true;\n    var value;\n\n    for (j = 0; j < sortedLabels.length; j++) {\n      i = sortedLabels[j];\n\n      if (columnType === \"datetime\") {\n        value = new Date(toFloat(i));\n        day = day && isDay(value);\n      } else if (columnType === \"number\") {\n        value = toFloat(i);\n      } else {\n        value = i;\n      }\n\n      rows2.push([value].concat(rows[i]));\n    }\n\n    if (columnType === \"datetime\") {\n      rows2.sort(sortByTime);\n    } else if (columnType === \"number\") {\n      rows2.sort(sortByNumberSeries);\n\n      for (i = 0; i < rows2.length; i++) {\n        rows2[i][0] = toStr(rows2[i][0]);\n      }\n\n      columnType = \"string\";\n    } // create datatable\n\n\n    var data = new this.library.visualization.DataTable();\n    columnType = columnType === \"datetime\" && day ? \"date\" : columnType;\n    data.addColumn(columnType, \"\");\n\n    for (i = 0; i < series.length; i++) {\n      data.addColumn(\"number\", series[i].name);\n    }\n\n    data.addRows(rows2);\n    return data;\n  };\n\n  var pendingRequests = [],\n      runningRequests = 0,\n      maxRequests = 4;\n\n  function pushRequest(url, success, error) {\n    pendingRequests.push([url, success, error]);\n    runNext();\n  }\n\n  function runNext() {\n    if (runningRequests < maxRequests) {\n      var request = pendingRequests.shift();\n\n      if (request) {\n        runningRequests++;\n        getJSON(request[0], request[1], request[2]);\n        runNext();\n      }\n    }\n  }\n\n  function requestComplete() {\n    runningRequests--;\n    runNext();\n  }\n\n  function getJSON(url, success, error) {\n    ajaxCall(url, success, function (jqXHR, textStatus, errorThrown) {\n      var message = typeof errorThrown === \"string\" ? errorThrown : errorThrown.message;\n      error(message);\n    });\n  }\n\n  function ajaxCall(url, success, error) {\n    var $ = window.jQuery || window.Zepto || window.$;\n\n    if ($ && $.ajax) {\n      $.ajax({\n        dataType: \"json\",\n        url: url,\n        success: success,\n        error: error,\n        complete: requestComplete\n      });\n    } else {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", url, true);\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n\n      xhr.onload = function () {\n        requestComplete();\n\n        if (xhr.status === 200) {\n          success(JSON.parse(xhr.responseText), xhr.statusText, xhr);\n        } else {\n          error(xhr, \"error\", xhr.statusText);\n        }\n      };\n\n      xhr.send();\n    }\n  }\n\n  var config = {};\n  var adapters = []; // helpers\n\n  function setText(element, text) {\n    if (document.body.innerText) {\n      element.innerText = text;\n    } else {\n      element.textContent = text;\n    }\n  } // TODO remove prefix for all messages\n\n\n  function chartError(element, message, noPrefix) {\n    if (!noPrefix) {\n      message = \"Error Loading Chart: \" + message;\n    }\n\n    setText(element, message);\n    element.style.color = \"#ff0000\";\n  }\n\n  function errorCatcher(chart) {\n    try {\n      chart.__render();\n    } catch (err) {\n      chartError(chart.element, err.message);\n      throw err;\n    }\n  }\n\n  function fetchDataSource(chart, dataSource) {\n    if (typeof dataSource === \"string\") {\n      pushRequest(dataSource, function (data) {\n        chart.rawData = data;\n        errorCatcher(chart);\n      }, function (message) {\n        chartError(chart.element, message);\n      });\n    } else if (typeof dataSource === \"function\") {\n      try {\n        dataSource(function (data) {\n          chart.rawData = data;\n          errorCatcher(chart);\n        }, function (message) {\n          chartError(chart.element, message, true);\n        });\n      } catch (err) {\n        chartError(chart.element, err, true);\n      }\n    } else {\n      chart.rawData = dataSource;\n      errorCatcher(chart);\n    }\n  }\n\n  function addDownloadButton(chart) {\n    var element = chart.element;\n    var link = document.createElement(\"a\");\n    var download = chart.options.download;\n\n    if (download === true) {\n      download = {};\n    } else if (typeof download === \"string\") {\n      download = {\n        filename: download\n      };\n    }\n\n    link.download = download.filename || \"chart.png\"; // https://caniuse.com/download\n\n    link.style.position = \"absolute\";\n    link.style.top = \"20px\";\n    link.style.right = \"20px\";\n    link.style.zIndex = 1000;\n    link.style.lineHeight = \"20px\";\n    link.target = \"_blank\"; // for safari\n\n    var image = document.createElement(\"img\");\n    image.alt = \"Download\";\n    image.style.border = \"none\"; // icon from font-awesome\n    // http://fa2png.io/\n\n    image.src = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABCFBMVEUAAADMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMywEsqxAAAAV3RSTlMAAQIDBggJCgsMDQ4PERQaHB0eISIjJCouLzE0OTo/QUJHSUpLTU5PUllhYmltcHh5foWLjI+SlaCio6atr7S1t7m6vsHHyM7R2tze5Obo7fHz9ff5+/1hlxK2AAAA30lEQVQYGUXBhVYCQQBA0TdYWAt2d3d3YWAHyur7/z9xgD16Lw0DW+XKx+1GgX+FRzM3HWQWrHl5N/oapW5RPe0PkBu+UYeICvozTWZVK23Ao04B79oJrOsJDOoxkZoQPWgX29pHpCZEk7rEvQYiNSFq1UMqvlCjJkRBS1R8hb00Vb/TajtBL7nTHE1X1vyMQF732dQhyF2o6SAwrzP06iUQzvwsArlnzcOdrgBhJyHa1QOgO9U1GsKuvjUTjavliZYQ8nNPapG6sap/3nrIdJ6bOWzmX/fy0XVpfzZP3S8OJT3g9EEiJwAAAABJRU5ErkJggg==\";\n    link.appendChild(image);\n    element.style.position = \"relative\";\n    chart.__downloadAttached = true; // mouseenter\n\n    chart.__enterEvent = addEvent(element, \"mouseover\", function (e) {\n      var related = e.relatedTarget; // check download option again to ensure it wasn't changed\n\n      if ((!related || related !== this && !childOf(this, related)) && chart.options.download) {\n        link.href = chart.toImage(download);\n        element.appendChild(link);\n      }\n    }); // mouseleave\n\n    chart.__leaveEvent = addEvent(element, \"mouseout\", function (e) {\n      var related = e.relatedTarget;\n\n      if (!related || related !== this && !childOf(this, related)) {\n        if (link.parentNode) {\n          link.parentNode.removeChild(link);\n        }\n      }\n    });\n  } // https://stackoverflow.com/questions/10149963/adding-event-listener-cross-browser\n\n\n  function addEvent(elem, event, fn) {\n    if (elem.addEventListener) {\n      elem.addEventListener(event, fn, false);\n      return fn;\n    } else {\n      var fn2 = function () {\n        // set the this pointer same as addEventListener when fn is called\n        return fn.call(elem, window.event);\n      };\n\n      elem.attachEvent(\"on\" + event, fn2);\n      return fn2;\n    }\n  }\n\n  function removeEvent(elem, event, fn) {\n    if (elem.removeEventListener) {\n      elem.removeEventListener(event, fn, false);\n    } else {\n      elem.detachEvent(\"on\" + event, fn);\n    }\n  } // https://gist.github.com/shawnbot/4166283\n\n\n  function childOf(p, c) {\n    if (p === c) {\n      return false;\n    }\n\n    while (c && c !== p) {\n      c = c.parentNode;\n    }\n\n    return c === p;\n  }\n\n  function getAdapterType(library) {\n    if (library) {\n      if (library.product === \"Highcharts\") {\n        return defaultExport$1;\n      } else if (library.charts) {\n        return defaultExport$2;\n      } else if (isFunction(library)) {\n        return defaultExport;\n      }\n    }\n\n    throw new Error(\"Unknown adapter\");\n  }\n\n  function addAdapter(library) {\n    var adapterType = getAdapterType(library);\n    var adapter = new adapterType(library);\n\n    if (adapters.indexOf(adapter) === -1) {\n      adapters.push(adapter);\n    }\n  }\n\n  function loadAdapters() {\n    if (\"Chart\" in window) {\n      addAdapter(window.Chart);\n    }\n\n    if (\"Highcharts\" in window) {\n      addAdapter(window.Highcharts);\n    }\n\n    if (window.google && window.google.charts) {\n      addAdapter(window.google);\n    }\n  }\n\n  function dataEmpty(data, chartType) {\n    if (chartType === \"PieChart\" || chartType === \"GeoChart\" || chartType === \"Timeline\") {\n      return data.length === 0;\n    } else {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].data.length > 0) {\n          return false;\n        }\n      }\n\n      return true;\n    }\n  }\n\n  function renderChart(chartType, chart) {\n    if (chart.options.messages && chart.options.messages.empty && dataEmpty(chart.data, chartType)) {\n      setText(chart.element, chart.options.messages.empty);\n    } else {\n      callAdapter(chartType, chart);\n\n      if (chart.options.download && !chart.__downloadAttached && chart.adapter === \"chartjs\") {\n        addDownloadButton(chart);\n      }\n    }\n  } // TODO remove chartType if cross-browser way\n  // to get the name of the chart class\n\n\n  function callAdapter(chartType, chart) {\n    var i, adapter, fnName, adapterName;\n    fnName = \"render\" + chartType;\n    adapterName = chart.options.adapter;\n    loadAdapters();\n\n    for (i = 0; i < adapters.length; i++) {\n      adapter = adapters[i];\n\n      if ((!adapterName || adapterName === adapter.name) && isFunction(adapter[fnName])) {\n        chart.adapter = adapter.name;\n        chart.__adapterObject = adapter;\n        return adapter[fnName](chart);\n      }\n    }\n\n    if (adapters.length > 0) {\n      throw new Error(\"No charting library found for \" + chartType);\n    } else {\n      throw new Error(\"No charting libraries found - be sure to include one before your charts\");\n    }\n  } // process data\n\n\n  var toFormattedKey = function (key, keyType) {\n    if (keyType === \"number\") {\n      key = toFloat(key);\n    } else if (keyType === \"datetime\") {\n      key = toDate(key);\n    } else {\n      key = toStr(key);\n    }\n\n    return key;\n  };\n\n  var formatSeriesData = function (data, keyType) {\n    var r = [],\n        key,\n        j;\n\n    for (j = 0; j < data.length; j++) {\n      if (keyType === \"bubble\") {\n        r.push([toFloat(data[j][0]), toFloat(data[j][1]), toFloat(data[j][2])]);\n      } else {\n        key = toFormattedKey(data[j][0], keyType);\n        r.push([key, toFloat(data[j][1])]);\n      }\n    }\n\n    if (keyType === \"datetime\") {\n      r.sort(sortByTime);\n    } else if (keyType === \"number\") {\n      r.sort(sortByNumberSeries);\n    }\n\n    return r;\n  };\n\n  function detectXType(series, noDatetime, options) {\n    if (dataEmpty(series)) {\n      if ((options.xmin || options.xmax) && (!options.xmin || isDate(options.xmin)) && (!options.xmax || isDate(options.xmax))) {\n        return \"datetime\";\n      } else {\n        return \"number\";\n      }\n    } else if (detectXTypeWithFunction(series, isNumber)) {\n      return \"number\";\n    } else if (!noDatetime && detectXTypeWithFunction(series, isDate)) {\n      return \"datetime\";\n    } else {\n      return \"string\";\n    }\n  }\n\n  function detectXTypeWithFunction(series, func) {\n    var i, j, data;\n\n    for (i = 0; i < series.length; i++) {\n      data = toArr(series[i].data);\n\n      for (j = 0; j < data.length; j++) {\n        if (!func(data[j][0])) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  } // creates a shallow copy of each element of the array\n  // elements are expected to be objects\n\n\n  function copySeries(series) {\n    var newSeries = [],\n        i,\n        j;\n\n    for (i = 0; i < series.length; i++) {\n      var copy = {};\n\n      for (j in series[i]) {\n        if (series[i].hasOwnProperty(j)) {\n          copy[j] = series[i][j];\n        }\n      }\n\n      newSeries.push(copy);\n    }\n\n    return newSeries;\n  }\n\n  function processSeries(chart, keyType, noDatetime) {\n    var i;\n    var opts = chart.options;\n    var series = chart.rawData; // see if one series or multiple\n\n    if (!isArray(series) || typeof series[0] !== \"object\" || isArray(series[0])) {\n      series = [{\n        name: opts.label,\n        data: series\n      }];\n      chart.hideLegend = true;\n    } else {\n      chart.hideLegend = false;\n    } // convert to array\n    // must come before dataEmpty check\n\n\n    series = copySeries(series);\n\n    for (i = 0; i < series.length; i++) {\n      series[i].data = toArr(series[i].data);\n    }\n\n    chart.xtype = keyType ? keyType : opts.discrete ? \"string\" : detectXType(series, noDatetime, opts); // right format\n\n    for (i = 0; i < series.length; i++) {\n      series[i].data = formatSeriesData(series[i].data, chart.xtype);\n    }\n\n    return series;\n  }\n\n  function processSimple(chart) {\n    var perfectData = toArr(chart.rawData),\n        i;\n\n    for (i = 0; i < perfectData.length; i++) {\n      perfectData[i] = [toStr(perfectData[i][0]), toFloat(perfectData[i][1])];\n    }\n\n    return perfectData;\n  } // define classes\n\n\n  var Chart = function Chart(element, dataSource, options) {\n    var elementId;\n\n    if (typeof element === \"string\") {\n      elementId = element;\n      element = document.getElementById(element);\n\n      if (!element) {\n        throw new Error(\"No element with id \" + elementId);\n      }\n    }\n\n    this.element = element;\n    this.options = merge(Chartkick.options, options || {});\n    this.dataSource = dataSource;\n    Chartkick.charts[element.id] = this;\n    fetchDataSource(this, dataSource);\n\n    if (this.options.refresh) {\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.getElement = function getElement() {\n    return this.element;\n  };\n\n  Chart.prototype.getDataSource = function getDataSource() {\n    return this.dataSource;\n  };\n\n  Chart.prototype.getData = function getData() {\n    return this.data;\n  };\n\n  Chart.prototype.getOptions = function getOptions() {\n    return this.options;\n  };\n\n  Chart.prototype.getChartObject = function getChartObject() {\n    return this.chart;\n  };\n\n  Chart.prototype.getAdapter = function getAdapter() {\n    return this.adapter;\n  };\n\n  Chart.prototype.updateData = function updateData(dataSource, options) {\n    this.dataSource = dataSource;\n\n    if (options) {\n      this.__updateOptions(options);\n    }\n\n    fetchDataSource(this, dataSource);\n  };\n\n  Chart.prototype.setOptions = function setOptions(options) {\n    this.__updateOptions(options);\n\n    this.redraw();\n  };\n\n  Chart.prototype.redraw = function redraw() {\n    fetchDataSource(this, this.rawData);\n  };\n\n  Chart.prototype.refreshData = function refreshData() {\n    if (typeof this.dataSource === \"string\") {\n      // prevent browser from caching\n      var sep = this.dataSource.indexOf(\"?\") === -1 ? \"?\" : \"&\";\n      var url = this.dataSource + sep + \"_=\" + new Date().getTime();\n      fetchDataSource(this, url);\n    } else if (typeof this.dataSource === \"function\") {\n      fetchDataSource(this, this.dataSource);\n    }\n  };\n\n  Chart.prototype.startRefresh = function startRefresh() {\n    var this$1 = this;\n    var refresh = this.options.refresh;\n\n    if (refresh && typeof this.dataSource !== \"string\" && typeof this.dataSource !== \"function\") {\n      throw new Error(\"Data source must be a URL or callback for refresh\");\n    }\n\n    if (!this.intervalId) {\n      if (refresh) {\n        this.intervalId = setInterval(function () {\n          this$1.refreshData();\n        }, refresh * 1000);\n      } else {\n        throw new Error(\"No refresh interval\");\n      }\n    }\n  };\n\n  Chart.prototype.stopRefresh = function stopRefresh() {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n  };\n\n  Chart.prototype.toImage = function toImage(download) {\n    if (this.adapter === \"chartjs\") {\n      if (download && download.background && download.background !== \"transparent\") {\n        // https://stackoverflow.com/questions/30464750/chartjs-line-chart-set-background-color\n        var canvas = this.chart.chart.canvas;\n        var ctx = this.chart.chart.ctx;\n        var tmpCanvas = document.createElement(\"canvas\");\n        var tmpCtx = tmpCanvas.getContext(\"2d\");\n        tmpCanvas.width = ctx.canvas.width;\n        tmpCanvas.height = ctx.canvas.height;\n        tmpCtx.fillStyle = download.background;\n        tmpCtx.fillRect(0, 0, tmpCanvas.width, tmpCanvas.height);\n        tmpCtx.drawImage(canvas, 0, 0);\n        return tmpCanvas.toDataURL(\"image/png\");\n      } else {\n        return this.chart.toBase64Image();\n      }\n    } else {\n      // TODO throw error in next major version\n      // throw new Error(\"Feature only available for Chart.js\");\n      return null;\n    }\n  };\n\n  Chart.prototype.destroy = function destroy() {\n    if (this.__adapterObject) {\n      this.__adapterObject.destroy(this);\n    }\n\n    if (this.__enterEvent) {\n      removeEvent(this.element, \"mouseover\", this.__enterEvent);\n    }\n\n    if (this.__leaveEvent) {\n      removeEvent(this.element, \"mouseout\", this.__leaveEvent);\n    }\n  };\n\n  Chart.prototype.__updateOptions = function __updateOptions(options) {\n    var updateRefresh = options.refresh && options.refresh !== this.options.refresh;\n    this.options = merge(Chartkick.options, options);\n\n    if (updateRefresh) {\n      this.stopRefresh();\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.__render = function __render() {\n    this.data = this.__processData();\n    renderChart(this.__chartName(), this);\n  };\n\n  Chart.prototype.__config = function __config() {\n    return config;\n  };\n\n  var LineChart = /*@__PURE__*/function (Chart) {\n    function LineChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) LineChart.__proto__ = Chart;\n    LineChart.prototype = Object.create(Chart && Chart.prototype);\n    LineChart.prototype.constructor = LineChart;\n\n    LineChart.prototype.__processData = function __processData() {\n      return processSeries(this);\n    };\n\n    LineChart.prototype.__chartName = function __chartName() {\n      return \"LineChart\";\n    };\n\n    return LineChart;\n  }(Chart);\n\n  var PieChart = /*@__PURE__*/function (Chart) {\n    function PieChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) PieChart.__proto__ = Chart;\n    PieChart.prototype = Object.create(Chart && Chart.prototype);\n    PieChart.prototype.constructor = PieChart;\n\n    PieChart.prototype.__processData = function __processData() {\n      return processSimple(this);\n    };\n\n    PieChart.prototype.__chartName = function __chartName() {\n      return \"PieChart\";\n    };\n\n    return PieChart;\n  }(Chart);\n\n  var ColumnChart = /*@__PURE__*/function (Chart) {\n    function ColumnChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) ColumnChart.__proto__ = Chart;\n    ColumnChart.prototype = Object.create(Chart && Chart.prototype);\n    ColumnChart.prototype.constructor = ColumnChart;\n\n    ColumnChart.prototype.__processData = function __processData() {\n      return processSeries(this, null, true);\n    };\n\n    ColumnChart.prototype.__chartName = function __chartName() {\n      return \"ColumnChart\";\n    };\n\n    return ColumnChart;\n  }(Chart);\n\n  var BarChart = /*@__PURE__*/function (Chart) {\n    function BarChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) BarChart.__proto__ = Chart;\n    BarChart.prototype = Object.create(Chart && Chart.prototype);\n    BarChart.prototype.constructor = BarChart;\n\n    BarChart.prototype.__processData = function __processData() {\n      return processSeries(this, null, true);\n    };\n\n    BarChart.prototype.__chartName = function __chartName() {\n      return \"BarChart\";\n    };\n\n    return BarChart;\n  }(Chart);\n\n  var AreaChart = /*@__PURE__*/function (Chart) {\n    function AreaChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) AreaChart.__proto__ = Chart;\n    AreaChart.prototype = Object.create(Chart && Chart.prototype);\n    AreaChart.prototype.constructor = AreaChart;\n\n    AreaChart.prototype.__processData = function __processData() {\n      return processSeries(this);\n    };\n\n    AreaChart.prototype.__chartName = function __chartName() {\n      return \"AreaChart\";\n    };\n\n    return AreaChart;\n  }(Chart);\n\n  var GeoChart = /*@__PURE__*/function (Chart) {\n    function GeoChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) GeoChart.__proto__ = Chart;\n    GeoChart.prototype = Object.create(Chart && Chart.prototype);\n    GeoChart.prototype.constructor = GeoChart;\n\n    GeoChart.prototype.__processData = function __processData() {\n      return processSimple(this);\n    };\n\n    GeoChart.prototype.__chartName = function __chartName() {\n      return \"GeoChart\";\n    };\n\n    return GeoChart;\n  }(Chart);\n\n  var ScatterChart = /*@__PURE__*/function (Chart) {\n    function ScatterChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) ScatterChart.__proto__ = Chart;\n    ScatterChart.prototype = Object.create(Chart && Chart.prototype);\n    ScatterChart.prototype.constructor = ScatterChart;\n\n    ScatterChart.prototype.__processData = function __processData() {\n      return processSeries(this, \"number\");\n    };\n\n    ScatterChart.prototype.__chartName = function __chartName() {\n      return \"ScatterChart\";\n    };\n\n    return ScatterChart;\n  }(Chart);\n\n  var BubbleChart = /*@__PURE__*/function (Chart) {\n    function BubbleChart() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) BubbleChart.__proto__ = Chart;\n    BubbleChart.prototype = Object.create(Chart && Chart.prototype);\n    BubbleChart.prototype.constructor = BubbleChart;\n\n    BubbleChart.prototype.__processData = function __processData() {\n      return processSeries(this, \"bubble\");\n    };\n\n    BubbleChart.prototype.__chartName = function __chartName() {\n      return \"BubbleChart\";\n    };\n\n    return BubbleChart;\n  }(Chart);\n\n  var Timeline = /*@__PURE__*/function (Chart) {\n    function Timeline() {\n      Chart.apply(this, arguments);\n    }\n\n    if (Chart) Timeline.__proto__ = Chart;\n    Timeline.prototype = Object.create(Chart && Chart.prototype);\n    Timeline.prototype.constructor = Timeline;\n\n    Timeline.prototype.__processData = function __processData() {\n      var i,\n          data = this.rawData;\n\n      for (i = 0; i < data.length; i++) {\n        data[i][1] = toDate(data[i][1]);\n        data[i][2] = toDate(data[i][2]);\n      }\n\n      return data;\n    };\n\n    Timeline.prototype.__chartName = function __chartName() {\n      return \"Timeline\";\n    };\n\n    return Timeline;\n  }(Chart);\n\n  var Chartkick = {\n    LineChart: LineChart,\n    PieChart: PieChart,\n    ColumnChart: ColumnChart,\n    BarChart: BarChart,\n    AreaChart: AreaChart,\n    GeoChart: GeoChart,\n    ScatterChart: ScatterChart,\n    BubbleChart: BubbleChart,\n    Timeline: Timeline,\n    charts: {},\n    configure: function (options) {\n      for (var key in options) {\n        if (options.hasOwnProperty(key)) {\n          config[key] = options[key];\n        }\n      }\n    },\n    setDefaultOptions: function (opts) {\n      Chartkick.options = opts;\n    },\n    eachChart: function (callback) {\n      for (var chartId in Chartkick.charts) {\n        if (Chartkick.charts.hasOwnProperty(chartId)) {\n          callback(Chartkick.charts[chartId]);\n        }\n      }\n    },\n    config: config,\n    options: {},\n    adapters: adapters,\n    addAdapter: addAdapter,\n    use: function (adapter) {\n      addAdapter(adapter);\n      return Chartkick;\n    }\n  }; // not ideal, but allows for simpler integration\n\n  if (typeof window !== \"undefined\" && !window.Chartkick) {\n    window.Chartkick = Chartkick;\n  } // backwards compatibility for esm require\n\n\n  Chartkick.default = Chartkick;\n  return Chartkick;\n});","map":{"version":3,"sources":["C:/Users/thoma/Documents/3rd year/Project/Docs/user-interfaces/library-test2/node_modules/chartkick/dist/chartkick.js"],"names":["global","factory","exports","module","define","amd","self","Chartkick","isArray","variable","Object","prototype","toString","call","isFunction","Function","isPlainObject","extend","target","source","key","undefined","merge","obj1","obj2","DATE_PATTERN","ISO8601_PATTERN","DECIMAL_SEPARATOR","String","charAt","parseISO8601","input","day","hour","matches","milliseconds","minutes","month","offset","result","seconds","type","year","match","parseInt","parseFloat","slice","Date","UTC","negativeValues","series","i","j","data","length","toStr","n","toFloat","toDate","str","replace","toArr","arr","hasOwnProperty","push","jsOptionsFunc","defaultOptions","hideLegend","setTitle","setMin","setMax","setStacked","setXtitle","setYtitle","chart","opts","chartOptions","options","legend","title","min","max","stacked","colors","xtitle","ytitle","library","sortByTime","a","b","getTime","sortByNumberSeries","sortByNumber","isMinute","d","getMilliseconds","getSeconds","isHour","getMinutes","isDay","getHours","isWeek","dayOfWeek","getDay","isMonth","getDate","isYear","getMonth","isDate","obj","isNaN","isNumber","byteSuffixes","formatValue","pre","value","axis","prefix","suffix","precision","round","byteScale","suffixIdx","baseValue","Error","toPrecision","zeros","num","Math","pow","toFixed","thousands","decimal","parts","split","seriesOption","option","allZeros","baseOptions","maintainAspectRatio","animation","tooltips","displayColors","callbacks","fontSize","fontColor","scales","yAxes","ticks","maxTicksLimit","scaleLabel","xAxes","gridLines","drawOnChartArea","time","defaultColors","display","position","text","setBarMin","setBarMax","labelString","addOpacity","hex","opacity","exec","notnull","x","setLabelSize","maxLabelSize","ceil","element","offsetWidth","labels","callback","substring","setFormatOptions","chartType","formatOptions","bytes","s","scale","myAxes","stepSize","label","item","datasets","datasetIndex","xLabel","yLabel","dataPoint","index","v","tooltipItem","dataLabel","valueLabel","jsOptions","createDataTable","week","minute","i$1","s$1","j$1","rows","rows2","xtype","sortedLabels","Array","indexOf","sort","k","i$2","s$2","d$1","j$2","point","y","r","color","backgroundColor","dataset","name","fill","borderColor","pointBackgroundColor","borderWidth","pointHoverBackgroundColor","stack","curve","lineTension","points","pointRadius","pointHitRadius","xmin","xmax","gte29","helpers","ticksKey","minTime","maxTime","value$1","timeDiff","unit","step","displayFormats","unitStepSize","tooltipFormat","defaultExport","renderLineChart","drawChart","renderPieChart","donut","cutoutPercentage","values","renderColumnChart","barOptions","renderAreaChart","renderBarChart","renderScatterChart","showLines","renderBubbleChart","destroy","code","window","console","log","JSON","stringify","innerHTML","ctx","getElementsByTagName","defaultOptions$1","xAxis","style","yAxis","credits","enabled","tooltip","plotOptions","areaspline","area","marker","hideLegend$1","verticalAlign","layout","align","setTitle$1","setMin$1","setMax$1","setStacked$1","stackedValue","stacking","setXtitle$1","setYtitle$1","jsOptions$1","setFormatOptions$1","formatter","pointFormatter","defaultExport$1","symbol","pie","innerSize","categories","newSeries","d2","renderTo","id","Chart","loaded","defaultOptions$2","chartArea","fontName","pointSize","textStyle","alignment","curveType","hAxis","titleTextStyle","gridlines","baselineColor","viewWindow","vAxis","hideLegend$2","setTitle$2","setMin$2","setMax$2","setBarMin$1","setBarMax$1","setStacked$2","isStacked","setXtitle$2","italic","setYtitle$2","jsOptions$2","resize","attachEvent","addEventListener","defaultExport$2","this$1","waitForLoaded","top","height","pieHole","visualization","DataTable","addColumn","addRows","areaOpacity","renderGeoChart","colorAxis","row","renderTimeline","lineHeight","clearChart","toJSON","draw","pack","runCallbacks","loadOptions","packages","config","__config","language","mapsApiKey","charts","load","cb","LineChart","Timeline","GeoChart","splice","columnType","concat","pendingRequests","runningRequests","maxRequests","pushRequest","url","success","error","runNext","request","shift","getJSON","requestComplete","ajaxCall","jqXHR","textStatus","errorThrown","message","$","jQuery","Zepto","ajax","dataType","complete","xhr","XMLHttpRequest","open","setRequestHeader","onload","status","parse","responseText","statusText","send","adapters","setText","document","body","innerText","textContent","chartError","noPrefix","errorCatcher","__render","err","fetchDataSource","dataSource","rawData","addDownloadButton","link","createElement","download","filename","right","zIndex","image","alt","border","src","appendChild","__downloadAttached","__enterEvent","addEvent","e","related","relatedTarget","childOf","href","toImage","__leaveEvent","parentNode","removeChild","elem","event","fn","fn2","removeEvent","removeEventListener","detachEvent","p","c","getAdapterType","product","addAdapter","adapterType","adapter","loadAdapters","Highcharts","google","dataEmpty","renderChart","messages","empty","callAdapter","fnName","adapterName","__adapterObject","toFormattedKey","keyType","formatSeriesData","detectXType","noDatetime","detectXTypeWithFunction","func","copySeries","copy","processSeries","discrete","processSimple","perfectData","elementId","getElementById","refresh","startRefresh","getElement","getDataSource","getData","getOptions","getChartObject","getAdapter","updateData","__updateOptions","setOptions","redraw","refreshData","sep","intervalId","setInterval","stopRefresh","clearInterval","background","canvas","tmpCanvas","tmpCtx","getContext","width","fillStyle","fillRect","drawImage","toDataURL","toBase64Image","updateRefresh","__processData","__chartName","apply","arguments","__proto__","create","constructor","PieChart","ColumnChart","BarChart","AreaChart","ScatterChart","BubbleChart","configure","setDefaultOptions","eachChart","chartId","use","default"],"mappings":"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","sourcesContent":["/*\n * Chartkick.js\n * Create beautiful charts with one line of JavaScript\n * https://github.com/ankane/chartkick.js\n * v3.2.1\n * MIT License\n */\n\n(function (global, factory) {\n  typeof exports === 'object' && typeof module !== 'undefined' ? module.exports = factory() :\n  typeof define === 'function' && define.amd ? define(factory) :\n  (global = global || self, global.Chartkick = factory());\n}(this, (function () { 'use strict';\n\n  function isArray(variable) {\n    return Object.prototype.toString.call(variable) === \"[object Array]\";\n  }\n\n  function isFunction(variable) {\n    return variable instanceof Function;\n  }\n\n  function isPlainObject(variable) {\n    // protect against prototype pollution, defense 2\n    return Object.prototype.toString.call(variable) === \"[object Object]\" && !isFunction(variable) && variable instanceof Object;\n  }\n\n  // https://github.com/madrobby/zepto/blob/master/src/zepto.js\n  function extend(target, source) {\n    var key;\n    for (key in source) {\n      // protect against prototype pollution, defense 1\n      if (key === \"__proto__\") { continue; }\n\n      if (isPlainObject(source[key]) || isArray(source[key])) {\n        if (isPlainObject(source[key]) && !isPlainObject(target[key])) {\n          target[key] = {};\n        }\n        if (isArray(source[key]) && !isArray(target[key])) {\n          target[key] = [];\n        }\n        extend(target[key], source[key]);\n      } else if (source[key] !== undefined) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  function merge(obj1, obj2) {\n    var target = {};\n    extend(target, obj1);\n    extend(target, obj2);\n    return target;\n  }\n\n  var DATE_PATTERN = /^(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)$/i;\n\n  // https://github.com/Do/iso8601.js\n  var ISO8601_PATTERN = /(\\d\\d\\d\\d)(-)?(\\d\\d)(-)?(\\d\\d)(T)?(\\d\\d)(:)?(\\d\\d)?(:)?(\\d\\d)?([.,]\\d+)?($|Z|([+-])(\\d\\d)(:)?(\\d\\d)?)/i;\n  var DECIMAL_SEPARATOR = String(1.5).charAt(1);\n\n  function parseISO8601(input) {\n    var day, hour, matches, milliseconds, minutes, month, offset, result, seconds, type, year;\n    type = Object.prototype.toString.call(input);\n    if (type === \"[object Date]\") {\n      return input;\n    }\n    if (type !== \"[object String]\") {\n      return;\n    }\n    matches = input.match(ISO8601_PATTERN);\n    if (matches) {\n      year = parseInt(matches[1], 10);\n      month = parseInt(matches[3], 10) - 1;\n      day = parseInt(matches[5], 10);\n      hour = parseInt(matches[7], 10);\n      minutes = matches[9] ? parseInt(matches[9], 10) : 0;\n      seconds = matches[11] ? parseInt(matches[11], 10) : 0;\n      milliseconds = matches[12] ? parseFloat(DECIMAL_SEPARATOR + matches[12].slice(1)) * 1000 : 0;\n      result = Date.UTC(year, month, day, hour, minutes, seconds, milliseconds);\n      if (matches[13] && matches[14]) {\n        offset = matches[15] * 60;\n        if (matches[17]) {\n          offset += parseInt(matches[17], 10);\n        }\n        offset *= matches[14] === \"-\" ? -1 : 1;\n        result -= offset * 60 * 1000;\n      }\n      return new Date(result);\n    }\n  }\n  // end iso8601.js\n\n  function negativeValues(series) {\n    var i, j, data;\n    for (i = 0; i < series.length; i++) {\n      data = series[i].data;\n      for (j = 0; j < data.length; j++) {\n        if (data[j][1] < 0) {\n          return true;\n        }\n      }\n    }\n    return false;\n  }\n\n  function toStr(n) {\n    return \"\" + n;\n  }\n\n  function toFloat(n) {\n    return parseFloat(n);\n  }\n\n  function toDate(n) {\n    var matches, year, month, day;\n    if (typeof n !== \"object\") {\n      if (typeof n === \"number\") {\n        n = new Date(n * 1000); // ms\n      } else {\n        n = toStr(n);\n        if ((matches = n.match(DATE_PATTERN))) {\n        year = parseInt(matches[1], 10);\n        month = parseInt(matches[3], 10) - 1;\n        day = parseInt(matches[5], 10);\n        return new Date(year, month, day);\n        } else { // str\n          // try our best to get the str into iso8601\n          // TODO be smarter about this\n          var str = n.replace(/ /, \"T\").replace(\" \", \"\").replace(\"UTC\", \"Z\");\n          n = parseISO8601(str) || new Date(n);\n        }\n      }\n    }\n    return n;\n  }\n\n  function toArr(n) {\n    if (!isArray(n)) {\n      var arr = [], i;\n      for (i in n) {\n        if (n.hasOwnProperty(i)) {\n          arr.push([i, n[i]]);\n        }\n      }\n      n = arr;\n    }\n    return n;\n  }\n\n  function jsOptionsFunc(defaultOptions, hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle) {\n    return function (chart, opts, chartOptions) {\n      var series = chart.data;\n      var options = merge({}, defaultOptions);\n      options = merge(options, chartOptions || {});\n\n      if (chart.hideLegend || \"legend\" in opts) {\n        hideLegend(options, opts.legend, chart.hideLegend);\n      }\n\n      if (opts.title) {\n        setTitle(options, opts.title);\n      }\n\n      // min\n      if (\"min\" in opts) {\n        setMin(options, opts.min);\n      } else if (!negativeValues(series)) {\n        setMin(options, 0);\n      }\n\n      // max\n      if (opts.max) {\n        setMax(options, opts.max);\n      }\n\n      if (\"stacked\" in opts) {\n        setStacked(options, opts.stacked);\n      }\n\n      if (opts.colors) {\n        options.colors = opts.colors;\n      }\n\n      if (opts.xtitle) {\n        setXtitle(options, opts.xtitle);\n      }\n\n      if (opts.ytitle) {\n        setYtitle(options, opts.ytitle);\n      }\n\n      // merge library last\n      options = merge(options, opts.library || {});\n\n      return options;\n    };\n  }\n\n  function sortByTime(a, b) {\n    return a[0].getTime() - b[0].getTime();\n  }\n\n  function sortByNumberSeries(a, b) {\n    return a[0] - b[0];\n  }\n\n  function sortByNumber(a, b) {\n    return a - b;\n  }\n\n  function isMinute(d) {\n    return d.getMilliseconds() === 0 && d.getSeconds() === 0;\n  }\n\n  function isHour(d) {\n    return isMinute(d) && d.getMinutes() === 0;\n  }\n\n  function isDay(d) {\n    return isHour(d) && d.getHours() === 0;\n  }\n\n  function isWeek(d, dayOfWeek) {\n    return isDay(d) && d.getDay() === dayOfWeek;\n  }\n\n  function isMonth(d) {\n    return isDay(d) && d.getDate() === 1;\n  }\n\n  function isYear(d) {\n    return isMonth(d) && d.getMonth() === 0;\n  }\n\n  function isDate(obj) {\n    return !isNaN(toDate(obj)) && toStr(obj).length >= 6;\n  }\n\n  function isNumber(obj) {\n    return typeof obj === \"number\";\n  }\n\n  var byteSuffixes = [\"bytes\", \"KB\", \"MB\", \"GB\", \"TB\", \"PB\", \"EB\"];\n\n  function formatValue(pre, value, options, axis) {\n    pre = pre || \"\";\n    if (options.prefix) {\n      if (value < 0) {\n        value = value * -1;\n        pre += \"-\";\n      }\n      pre += options.prefix;\n    }\n\n    var suffix = options.suffix || \"\";\n    var precision = options.precision;\n    var round = options.round;\n\n    if (options.byteScale) {\n      var suffixIdx;\n      var baseValue = axis ? options.byteScale : value;\n\n      if (baseValue >= 1152921504606846976) {\n        value /= 1152921504606846976;\n        suffixIdx = 6;\n      } else if (baseValue >= 1125899906842624) {\n        value /= 1125899906842624;\n        suffixIdx = 5;\n      } else if (baseValue >= 1099511627776) {\n        value /= 1099511627776;\n        suffixIdx = 4;\n      } else if (baseValue >= 1073741824) {\n        value /= 1073741824;\n        suffixIdx = 3;\n      } else if (baseValue >= 1048576) {\n        value /= 1048576;\n        suffixIdx = 2;\n      } else if (baseValue >= 1024) {\n        value /= 1024;\n        suffixIdx = 1;\n      } else {\n        suffixIdx = 0;\n      }\n\n      // TODO handle manual precision case\n      if (precision === undefined && round === undefined) {\n        if (value >= 1023.5) {\n          if (suffixIdx < byteSuffixes.length - 1) {\n            value = 1.0;\n            suffixIdx += 1;\n          }\n        }\n        precision = value >= 1000 ? 4 : 3;\n      }\n      suffix = \" \" + byteSuffixes[suffixIdx];\n    }\n\n    if (precision !== undefined && round !== undefined) {\n      throw Error(\"Use either round or precision, not both\");\n    }\n\n    if (!axis) {\n      if (precision !== undefined) {\n        value = value.toPrecision(precision);\n        if (!options.zeros) {\n          value = parseFloat(value);\n        }\n      }\n\n      if (round !== undefined) {\n        if (round < 0) {\n          var num = Math.pow(10, -1 * round);\n          value = parseInt((1.0 * value / num).toFixed(0)) * num;\n        } else {\n          value = value.toFixed(round);\n          if (!options.zeros) {\n            value = parseFloat(value);\n          }\n        }\n      }\n    }\n\n    if (options.thousands || options.decimal) {\n      value = toStr(value);\n      var parts = value.split(\".\");\n      value = parts[0];\n      if (options.thousands) {\n        value = value.replace(/\\B(?=(\\d{3})+(?!\\d))/g, options.thousands);\n      }\n      if (parts.length > 1) {\n        value += (options.decimal || \".\") + parts[1];\n      }\n    }\n\n    return pre + value + suffix;\n  }\n\n  function seriesOption(chart, series, option) {\n    if (option in series) {\n      return series[option];\n    } else if (option in chart.options) {\n      return chart.options[option];\n    }\n    return null;\n  }\n\n  function allZeros(data) {\n    var i, j, d;\n    for (i = 0; i < data.length; i++) {\n      d = data[i].data;\n      for (j = 0; j < d.length; j++) {\n        if (d[j][1] != 0) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  var baseOptions = {\n    maintainAspectRatio: false,\n    animation: false,\n    tooltips: {\n      displayColors: false,\n      callbacks: {}\n    },\n    legend: {},\n    title: {fontSize: 20, fontColor: \"#333\"}\n  };\n\n  var defaultOptions = {\n    scales: {\n      yAxes: [\n        {\n          ticks: {\n            maxTicksLimit: 4\n          },\n          scaleLabel: {\n            fontSize: 16,\n            // fontStyle: \"bold\",\n            fontColor: \"#333\"\n          }\n        }\n      ],\n      xAxes: [\n        {\n          gridLines: {\n            drawOnChartArea: false\n          },\n          scaleLabel: {\n            fontSize: 16,\n            // fontStyle: \"bold\",\n            fontColor: \"#333\"\n          },\n          time: {},\n          ticks: {}\n        }\n      ]\n    }\n  };\n\n  // http://there4.io/2012/05/02/google-chart-color-list/\n  var defaultColors = [\n    \"#3366CC\", \"#DC3912\", \"#FF9900\", \"#109618\", \"#990099\", \"#3B3EAC\", \"#0099C6\",\n    \"#DD4477\", \"#66AA00\", \"#B82E2E\", \"#316395\", \"#994499\", \"#22AA99\", \"#AAAA11\",\n    \"#6633CC\", \"#E67300\", \"#8B0707\", \"#329262\", \"#5574A6\", \"#651067\"\n  ];\n\n  var hideLegend = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.display = !!legend;\n      if (legend && legend !== true) {\n        options.legend.position = legend;\n      }\n    } else if (hideLegend) {\n      options.legend.display = false;\n    }\n  };\n\n  var setTitle = function (options, title) {\n    options.title.display = true;\n    options.title.text = title;\n  };\n\n  var setMin = function (options, min) {\n    if (min !== null) {\n      options.scales.yAxes[0].ticks.min = toFloat(min);\n    }\n  };\n\n  var setMax = function (options, max) {\n    options.scales.yAxes[0].ticks.max = toFloat(max);\n  };\n\n  var setBarMin = function (options, min) {\n    if (min !== null) {\n      options.scales.xAxes[0].ticks.min = toFloat(min);\n    }\n  };\n\n  var setBarMax = function (options, max) {\n    options.scales.xAxes[0].ticks.max = toFloat(max);\n  };\n\n  var setStacked = function (options, stacked) {\n    options.scales.xAxes[0].stacked = !!stacked;\n    options.scales.yAxes[0].stacked = !!stacked;\n  };\n\n  var setXtitle = function (options, title) {\n    options.scales.xAxes[0].scaleLabel.display = true;\n    options.scales.xAxes[0].scaleLabel.labelString = title;\n  };\n\n  var setYtitle = function (options, title) {\n    options.scales.yAxes[0].scaleLabel.display = true;\n    options.scales.yAxes[0].scaleLabel.labelString = title;\n  };\n\n  // https://stackoverflow.com/questions/5623838/rgb-to-hex-and-hex-to-rgb\n  var addOpacity = function(hex, opacity) {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    return result ? \"rgba(\" + parseInt(result[1], 16) + \", \" + parseInt(result[2], 16) + \", \" + parseInt(result[3], 16) + \", \" + opacity + \")\" : hex;\n  };\n\n  // check if not null or undefined\n  // https://stackoverflow.com/a/27757708/1177228\n  var notnull = function(x) {\n    return x != null;\n  };\n\n  var setLabelSize = function (chart, data, options) {\n    var maxLabelSize = Math.ceil(chart.element.offsetWidth / 4.0 / data.labels.length);\n    if (maxLabelSize > 25) {\n      maxLabelSize = 25;\n    } else if (maxLabelSize < 10) {\n      maxLabelSize = 10;\n    }\n    if (!options.scales.xAxes[0].ticks.callback) {\n      options.scales.xAxes[0].ticks.callback = function (value) {\n        value = toStr(value);\n        if (value.length > maxLabelSize) {\n          return value.substring(0, maxLabelSize - 2) + \"...\";\n        } else {\n          return value;\n        }\n      };\n    }\n  };\n\n  var setFormatOptions = function(chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chart.options.bytes) {\n      var series = chart.data;\n      if (chartType === \"pie\") {\n        series = [{data: series}];\n      }\n\n      // calculate max\n      var max = 0;\n      for (var i = 0; i < series.length; i++) {\n        var s = series[i];\n        for (var j = 0; j < s.data.length; j++) {\n          if (s.data[j][1] > max) {\n            max = s.data[j][1];\n          }\n        }\n      }\n\n      // calculate scale\n      var scale = 1;\n      while (max >= 1024) {\n        scale *= 1024;\n        max /= 1024;\n      }\n\n      // set step size\n      formatOptions.byteScale = scale;\n    }\n\n    if (chartType !== \"pie\") {\n      var myAxes = options.scales.yAxes;\n      if (chartType === \"bar\") {\n        myAxes = options.scales.xAxes;\n      }\n\n      if (formatOptions.byteScale) {\n        if (!myAxes[0].ticks.stepSize) {\n          myAxes[0].ticks.stepSize = formatOptions.byteScale / 2;\n        }\n        if (!myAxes[0].ticks.maxTicksLimit) {\n          myAxes[0].ticks.maxTicksLimit = 4;\n        }\n      }\n\n      if (!myAxes[0].ticks.callback) {\n        myAxes[0].ticks.callback = function (value) {\n          return formatValue(\"\", value, formatOptions, true);\n        };\n      }\n    }\n\n    if (!options.tooltips.callbacks.label) {\n      if (chartType === \"scatter\") {\n        options.tooltips.callbacks.label = function (item, data) {\n          var label = data.datasets[item.datasetIndex].label || '';\n          if (label) {\n            label += ': ';\n          }\n          return label + '(' + item.xLabel + ', ' + item.yLabel + ')';\n        };\n      } else if (chartType === \"bubble\") {\n        options.tooltips.callbacks.label = function (item, data) {\n          var label = data.datasets[item.datasetIndex].label || '';\n          if (label) {\n            label += ': ';\n          }\n          var dataPoint = data.datasets[item.datasetIndex].data[item.index];\n          return label + '(' + item.xLabel + ', ' + item.yLabel + ', ' + dataPoint.v + ')';\n        };\n      } else if (chartType === \"pie\") {\n        // need to use separate label for pie charts\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          var dataLabel = data.labels[tooltipItem.index];\n          var value = ': ';\n\n          if (isArray(dataLabel)) {\n            // show value on first line of multiline label\n            // need to clone because we are changing the value\n            dataLabel = dataLabel.slice();\n            dataLabel[0] += value;\n          } else {\n            dataLabel += value;\n          }\n\n          return formatValue(dataLabel, data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index], formatOptions);\n        };\n      } else {\n        var valueLabel = chartType === \"bar\" ? \"xLabel\" : \"yLabel\";\n        options.tooltips.callbacks.label = function (tooltipItem, data) {\n          var label = data.datasets[tooltipItem.datasetIndex].label || '';\n          if (label) {\n            label += ': ';\n          }\n          return formatValue(label, tooltipItem[valueLabel], formatOptions);\n        };\n      }\n    }\n  };\n\n  var jsOptions = jsOptionsFunc(merge(baseOptions, defaultOptions), hideLegend, setTitle, setMin, setMax, setStacked, setXtitle, setYtitle);\n\n  var createDataTable = function (chart, options, chartType, library) {\n    var datasets = [];\n    var labels = [];\n\n    var colors = chart.options.colors || defaultColors;\n\n    var day = true;\n    var week = true;\n    var dayOfWeek;\n    var month = true;\n    var year = true;\n    var hour = true;\n    var minute = true;\n\n    var series = chart.data;\n\n    var max = 0;\n    if (chartType === \"bubble\") {\n      for (var i$1 = 0; i$1 < series.length; i$1++) {\n        var s$1 = series[i$1];\n        for (var j$1 = 0; j$1 < s$1.data.length; j$1++) {\n          if (s$1.data[j$1][2] > max) {\n            max = s$1.data[j$1][2];\n          }\n        }\n      }\n    }\n\n    var i, j, s, d, key, rows = [], rows2 = [];\n\n    if (chartType === \"bar\" || chartType === \"column\" || (chart.xtype !== \"number\" && chart.xtype !== \"bubble\")) {\n      var sortedLabels = [];\n\n      for (i = 0; i < series.length; i++) {\n        s = series[i];\n\n        for (j = 0; j < s.data.length; j++) {\n          d = s.data[j];\n          key = chart.xtype == \"datetime\" ? d[0].getTime() : d[0];\n          if (!rows[key]) {\n            rows[key] = new Array(series.length);\n          }\n          rows[key][i] = toFloat(d[1]);\n          if (sortedLabels.indexOf(key) === -1) {\n            sortedLabels.push(key);\n          }\n        }\n      }\n\n      if (chart.xtype === \"datetime\" || chart.xtype === \"number\") {\n        sortedLabels.sort(sortByNumber);\n      }\n\n      for (j = 0; j < series.length; j++) {\n        rows2.push([]);\n      }\n\n      var value;\n      var k;\n      for (k = 0; k < sortedLabels.length; k++) {\n        i = sortedLabels[k];\n        if (chart.xtype === \"datetime\") {\n          value = new Date(toFloat(i));\n          // TODO make this efficient\n          day = day && isDay(value);\n          if (!dayOfWeek) {\n            dayOfWeek = value.getDay();\n          }\n          week = week && isWeek(value, dayOfWeek);\n          month = month && isMonth(value);\n          year = year && isYear(value);\n          hour = hour && isHour(value);\n          minute = minute && isMinute(value);\n        } else {\n          value = i;\n        }\n        labels.push(value);\n        for (j = 0; j < series.length; j++) {\n          // Chart.js doesn't like undefined\n          rows2[j].push(rows[i][j] === undefined ? null : rows[i][j]);\n        }\n      }\n    } else {\n      for (var i$2 = 0; i$2 < series.length; i$2++) {\n        var s$2 = series[i$2];\n        var d$1 = [];\n        for (var j$2 = 0; j$2 < s$2.data.length; j$2++) {\n          var point = {\n            x: toFloat(s$2.data[j$2][0]),\n            y: toFloat(s$2.data[j$2][1])\n          };\n          if (chartType === \"bubble\") {\n            point.r = toFloat(s$2.data[j$2][2]) * 20 / max;\n            // custom attribute, for tooltip\n            point.v = s$2.data[j$2][2];\n          }\n          d$1.push(point);\n        }\n        rows2.push(d$1);\n      }\n    }\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      var color = s.color || colors[i];\n      var backgroundColor = chartType !== \"line\" ? addOpacity(color, 0.5) : color;\n\n      var dataset = {\n        label: s.name || \"\",\n        data: rows2[i],\n        fill: chartType === \"area\",\n        borderColor: color,\n        backgroundColor: backgroundColor,\n        pointBackgroundColor: color,\n        borderWidth: 2,\n        pointHoverBackgroundColor: color\n      };\n\n      if (s.stack) {\n        dataset.stack = s.stack;\n      }\n\n      var curve = seriesOption(chart, s, \"curve\");\n      if (curve === false) {\n        dataset.lineTension = 0;\n      }\n\n      var points = seriesOption(chart, s, \"points\");\n      if (points === false) {\n        dataset.pointRadius = 0;\n        dataset.pointHitRadius = 5;\n      }\n\n      dataset = merge(dataset, chart.options.dataset || {});\n      dataset = merge(dataset, s.library || {});\n      dataset = merge(dataset, s.dataset || {});\n\n      datasets.push(dataset);\n    }\n\n    var xmin = chart.options.xmin;\n    var xmax = chart.options.xmax;\n\n    if (chart.xtype === \"datetime\") {\n      // hacky check for Chart.js >= 2.9.0\n      // https://github.com/chartjs/Chart.js/compare/v2.8.0...v2.9.0\n      var gte29 = \"math\" in library.helpers;\n      var ticksKey = gte29 ? \"ticks\" : \"time\";\n      if (notnull(xmin)) {\n        options.scales.xAxes[0][ticksKey].min = toDate(xmin).getTime();\n      }\n      if (notnull(xmax)) {\n        options.scales.xAxes[0][ticksKey].max = toDate(xmax).getTime();\n      }\n    } else if (chart.xtype === \"number\") {\n      if (notnull(xmin)) {\n        options.scales.xAxes[0].ticks.min = xmin;\n      }\n      if (notnull(xmax)) {\n        options.scales.xAxes[0].ticks.max = xmax;\n      }\n    }\n\n    // for empty datetime chart\n    if (chart.xtype === \"datetime\" && labels.length === 0) {\n      if (notnull(xmin)) {\n        labels.push(toDate(xmin));\n      }\n      if (notnull(xmax)) {\n        labels.push(toDate(xmax));\n      }\n      day = false;\n      week = false;\n      month = false;\n      year = false;\n      hour = false;\n      minute = false;\n    }\n\n    if (chart.xtype === \"datetime\" && labels.length > 0) {\n      var minTime = (notnull(xmin) ? toDate(xmin) : labels[0]).getTime();\n      var maxTime = (notnull(xmax) ? toDate(xmax) : labels[0]).getTime();\n\n      for (i = 1; i < labels.length; i++) {\n        var value$1 = labels[i].getTime();\n        if (value$1 < minTime) {\n          minTime = value$1;\n        }\n        if (value$1 > maxTime) {\n          maxTime = value$1;\n        }\n      }\n\n      var timeDiff = (maxTime - minTime) / (86400 * 1000.0);\n\n      if (!options.scales.xAxes[0].time.unit) {\n        var step;\n        if (year || timeDiff > 365 * 10) {\n          options.scales.xAxes[0].time.unit = \"year\";\n          step = 365;\n        } else if (month || timeDiff > 30 * 10) {\n          options.scales.xAxes[0].time.unit = \"month\";\n          step = 30;\n        } else if (day || timeDiff > 10) {\n          options.scales.xAxes[0].time.unit = \"day\";\n          step = 1;\n        } else if (hour || timeDiff > 0.5) {\n          options.scales.xAxes[0].time.displayFormats = {hour: \"MMM D, h a\"};\n          options.scales.xAxes[0].time.unit = \"hour\";\n          step = 1 / 24.0;\n        } else if (minute) {\n          options.scales.xAxes[0].time.displayFormats = {minute: \"h:mm a\"};\n          options.scales.xAxes[0].time.unit = \"minute\";\n          step = 1 / 24.0 / 60.0;\n        }\n\n        if (step && timeDiff > 0) {\n          var unitStepSize = Math.ceil(timeDiff / step / (chart.element.offsetWidth / 100.0));\n          if (week && step === 1) {\n            unitStepSize = Math.ceil(unitStepSize / 7.0) * 7;\n          }\n          options.scales.xAxes[0].time.unitStepSize = unitStepSize;\n        }\n      }\n\n      if (!options.scales.xAxes[0].time.tooltipFormat) {\n        if (day) {\n          options.scales.xAxes[0].time.tooltipFormat = \"ll\";\n        } else if (hour) {\n          options.scales.xAxes[0].time.tooltipFormat = \"MMM D, h a\";\n        } else if (minute) {\n          options.scales.xAxes[0].time.tooltipFormat = \"h:mm a\";\n        }\n      }\n    }\n\n    var data = {\n      labels: labels,\n      datasets: datasets\n    };\n\n    return data;\n  };\n\n  var defaultExport = function defaultExport(library) {\n    this.name = \"chartjs\";\n    this.library = library;\n  };\n\n  defaultExport.prototype.renderLineChart = function renderLineChart (chart, chartType) {\n    var chartOptions = {};\n    // fix for https://github.com/chartjs/Chart.js/issues/2441\n    if (!chart.options.max && allZeros(chart.data)) {\n      chartOptions.max = 1;\n    }\n\n    var options = jsOptions(chart, merge(chartOptions, chart.options));\n    setFormatOptions(chart, options, chartType);\n\n    var data = createDataTable(chart, options, chartType || \"line\", this.library);\n\n    if (chart.xtype === \"number\") {\n      options.scales.xAxes[0].type = \"linear\";\n      options.scales.xAxes[0].position = \"bottom\";\n    } else {\n      options.scales.xAxes[0].type = chart.xtype === \"string\" ? \"category\" : \"time\";\n    }\n\n    this.drawChart(chart, \"line\", data, options);\n  };\n\n  defaultExport.prototype.renderPieChart = function renderPieChart (chart) {\n    var options = merge({}, baseOptions);\n    if (chart.options.donut) {\n      options.cutoutPercentage = 50;\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend(options, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle(options, chart.options.title);\n    }\n\n    options = merge(options, chart.options.library || {});\n    setFormatOptions(chart, options, \"pie\");\n\n    var labels = [];\n    var values = [];\n    for (var i = 0; i < chart.data.length; i++) {\n      var point = chart.data[i];\n      labels.push(point[0]);\n      values.push(point[1]);\n    }\n\n    var dataset = {\n      data: values,\n      backgroundColor: chart.options.colors || defaultColors\n    };\n    dataset = merge(dataset, chart.options.dataset || {});\n\n    var data = {\n      labels: labels,\n      datasets: [dataset]\n    };\n\n    this.drawChart(chart, \"pie\", data, options);\n  };\n\n  defaultExport.prototype.renderColumnChart = function renderColumnChart (chart, chartType) {\n    var options;\n    if (chartType === \"bar\") {\n      var barOptions = merge(baseOptions, defaultOptions);\n      delete barOptions.scales.yAxes[0].ticks.maxTicksLimit;\n      options = jsOptionsFunc(barOptions, hideLegend, setTitle, setBarMin, setBarMax, setStacked, setXtitle, setYtitle)(chart, chart.options);\n    } else {\n      options = jsOptions(chart, chart.options);\n    }\n    setFormatOptions(chart, options, chartType);\n    var data = createDataTable(chart, options, \"column\", this.library);\n    if (chartType !== \"bar\") {\n      setLabelSize(chart, data, options);\n    }\n    this.drawChart(chart, (chartType === \"bar\" ? \"horizontalBar\" : \"bar\"), data, options);\n  };\n\n  defaultExport.prototype.renderAreaChart = function renderAreaChart (chart) {\n    this.renderLineChart(chart, \"area\");\n  };\n\n  defaultExport.prototype.renderBarChart = function renderBarChart (chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport.prototype.renderScatterChart = function renderScatterChart (chart, chartType) {\n    chartType = chartType || \"scatter\";\n\n    var options = jsOptions(chart, chart.options);\n    setFormatOptions(chart, options, chartType);\n\n    if (!(\"showLines\" in options)) {\n      options.showLines = false;\n    }\n\n    var data = createDataTable(chart, options, chartType, this.library);\n\n    options.scales.xAxes[0].type = \"linear\";\n    options.scales.xAxes[0].position = \"bottom\";\n\n    this.drawChart(chart, chartType, data, options);\n  };\n\n  defaultExport.prototype.renderBubbleChart = function renderBubbleChart (chart) {\n    this.renderScatterChart(chart, \"bubble\");\n  };\n\n  defaultExport.prototype.destroy = function destroy (chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport.prototype.drawChart = function drawChart (chart, type, data, options) {\n    this.destroy(chart);\n\n    var chartOptions = {\n      type: type,\n      data: data,\n      options: options\n    };\n\n    if (chart.options.code) {\n      window.console.log(\"new Chart(ctx, \" + JSON.stringify(chartOptions) + \");\");\n    }\n\n    chart.element.innerHTML = \"<canvas></canvas>\";\n    var ctx = chart.element.getElementsByTagName(\"CANVAS\")[0];\n    chart.chart = new this.library(ctx, chartOptions);\n  };\n\n  var defaultOptions$1 = {\n    chart: {},\n    xAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    yAxis: {\n      title: {\n        text: null\n      },\n      labels: {\n        style: {\n          fontSize: \"12px\"\n        }\n      }\n    },\n    title: {\n      text: null\n    },\n    credits: {\n      enabled: false\n    },\n    legend: {\n      borderWidth: 0\n    },\n    tooltip: {\n      style: {\n        fontSize: \"12px\"\n      }\n    },\n    plotOptions: {\n      areaspline: {},\n      area: {},\n      series: {\n        marker: {}\n      }\n    }\n  };\n\n  var hideLegend$1 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      options.legend.enabled = !!legend;\n      if (legend && legend !== true) {\n        if (legend === \"top\" || legend === \"bottom\") {\n          options.legend.verticalAlign = legend;\n        } else {\n          options.legend.layout = \"vertical\";\n          options.legend.verticalAlign = \"middle\";\n          options.legend.align = legend;\n        }\n      }\n    } else if (hideLegend) {\n      options.legend.enabled = false;\n    }\n  };\n\n  var setTitle$1 = function (options, title) {\n    options.title.text = title;\n  };\n\n  var setMin$1 = function (options, min) {\n    options.yAxis.min = min;\n  };\n\n  var setMax$1 = function (options, max) {\n    options.yAxis.max = max;\n  };\n\n  var setStacked$1 = function (options, stacked) {\n    var stackedValue = stacked ? (stacked === true ? \"normal\" : stacked) : null;\n    options.plotOptions.series.stacking = stackedValue;\n    options.plotOptions.area.stacking = stackedValue;\n    options.plotOptions.areaspline.stacking = stackedValue;\n  };\n\n  var setXtitle$1 = function (options, title) {\n    options.xAxis.title.text = title;\n  };\n\n  var setYtitle$1 = function (options, title) {\n    options.yAxis.title.text = title;\n  };\n\n  var jsOptions$1 = jsOptionsFunc(defaultOptions$1, hideLegend$1, setTitle$1, setMin$1, setMax$1, setStacked$1, setXtitle$1, setYtitle$1);\n\n  var setFormatOptions$1 = function(chart, options, chartType) {\n    var formatOptions = {\n      prefix: chart.options.prefix,\n      suffix: chart.options.suffix,\n      thousands: chart.options.thousands,\n      decimal: chart.options.decimal,\n      precision: chart.options.precision,\n      round: chart.options.round,\n      zeros: chart.options.zeros\n    };\n\n    if (chartType !== \"pie\" && !options.yAxis.labels.formatter) {\n      options.yAxis.labels.formatter = function () {\n        return formatValue(\"\", this.value, formatOptions);\n      };\n    }\n\n    if (!options.tooltip.pointFormatter) {\n      options.tooltip.pointFormatter = function () {\n        return '<span style=\"color:' + this.color + '\">\\u25CF</span> ' + formatValue(this.series.name + ': <b>', this.y, formatOptions) + '</b><br/>';\n      };\n    }\n  };\n\n  var defaultExport$1 = function defaultExport(library) {\n    this.name = \"highcharts\";\n    this.library = library;\n  };\n\n  defaultExport$1.prototype.renderLineChart = function renderLineChart (chart, chartType) {\n    chartType = chartType || \"spline\";\n    var chartOptions = {};\n    if (chartType === \"areaspline\") {\n      chartOptions = {\n        plotOptions: {\n          areaspline: {\n            stacking: \"normal\"\n          },\n          area: {\n            stacking: \"normal\"\n          },\n          series: {\n            marker: {\n              enabled: false\n            }\n          }\n        }\n      };\n    }\n\n    if (chart.options.curve === false) {\n      if (chartType === \"areaspline\") {\n        chartType = \"area\";\n      } else if (chartType === \"spline\") {\n        chartType = \"line\";\n      }\n    }\n\n    var options = jsOptions$1(chart, chart.options, chartOptions), data, i, j;\n    options.xAxis.type = chart.xtype === \"string\" ? \"category\" : (chart.xtype === \"number\" ? \"linear\" : \"datetime\");\n    if (!options.chart.type) {\n      options.chart.type = chartType;\n    }\n    setFormatOptions$1(chart, options, chartType);\n\n    var series = chart.data;\n    for (i = 0; i < series.length; i++) {\n      series[i].name = series[i].name || \"Value\";\n      data = series[i].data;\n      if (chart.xtype === \"datetime\") {\n        for (j = 0; j < data.length; j++) {\n          data[j][0] = data[j][0].getTime();\n        }\n      }\n      series[i].marker = {symbol: \"circle\"};\n      if (chart.options.points === false) {\n        series[i].marker.enabled = false;\n      }\n    }\n\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderScatterChart = function renderScatterChart (chart) {\n    var options = jsOptions$1(chart, chart.options, {});\n    options.chart.type = \"scatter\";\n    this.drawChart(chart, chart.data, options);\n  };\n\n  defaultExport$1.prototype.renderPieChart = function renderPieChart (chart) {\n    var chartOptions = merge(defaultOptions$1, {});\n\n    if (chart.options.colors) {\n      chartOptions.colors = chart.options.colors;\n    }\n    if (chart.options.donut) {\n      chartOptions.plotOptions = {pie: {innerSize: \"50%\"}};\n    }\n\n    if (\"legend\" in chart.options) {\n      hideLegend$1(chartOptions, chart.options.legend);\n    }\n\n    if (chart.options.title) {\n      setTitle$1(chartOptions, chart.options.title);\n    }\n\n    var options = merge(chartOptions, chart.options.library || {});\n    setFormatOptions$1(chart, options, \"pie\");\n    var series = [{\n      type: \"pie\",\n      name: chart.options.label || \"Value\",\n      data: chart.data\n    }];\n\n    this.drawChart(chart, series, options);\n  };\n\n  defaultExport$1.prototype.renderColumnChart = function renderColumnChart (chart, chartType) {\n    chartType = chartType || \"column\";\n    var series = chart.data;\n    var options = jsOptions$1(chart, chart.options), i, j, s, d, rows = [], categories = [];\n    options.chart.type = chartType;\n    setFormatOptions$1(chart, options, chartType);\n\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        if (!rows[d[0]]) {\n          rows[d[0]] = new Array(series.length);\n          categories.push(d[0]);\n        }\n        rows[d[0]][i] = d[1];\n      }\n    }\n\n    if (chart.xtype === \"number\") {\n      categories.sort(sortByNumber);\n    }\n\n    options.xAxis.categories = categories;\n\n    var newSeries = [], d2;\n    for (i = 0; i < series.length; i++) {\n      d = [];\n      for (j = 0; j < categories.length; j++) {\n        d.push(rows[categories[j]][i] || 0);\n      }\n\n      d2 = {\n        name: series[i].name || \"Value\",\n        data: d\n      };\n      if (series[i].stack) {\n        d2.stack = series[i].stack;\n      }\n\n      newSeries.push(d2);\n    }\n\n    this.drawChart(chart, newSeries, options);\n  };\n\n  defaultExport$1.prototype.renderBarChart = function renderBarChart (chart) {\n    this.renderColumnChart(chart, \"bar\");\n  };\n\n  defaultExport$1.prototype.renderAreaChart = function renderAreaChart (chart) {\n    this.renderLineChart(chart, \"areaspline\");\n  };\n\n  defaultExport$1.prototype.destroy = function destroy (chart) {\n    if (chart.chart) {\n      chart.chart.destroy();\n    }\n  };\n\n  defaultExport$1.prototype.drawChart = function drawChart (chart, data, options) {\n    this.destroy(chart);\n\n    options.chart.renderTo = chart.element.id;\n    options.series = data;\n\n    if (chart.options.code) {\n      window.console.log(\"new Highcharts.Chart(\" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.Chart(options);\n  };\n\n  var loaded = {};\n  var callbacks = [];\n\n  // Set chart options\n  var defaultOptions$2 = {\n    chartArea: {},\n    fontName: \"'Lucida Grande', 'Lucida Sans Unicode', Verdana, Arial, Helvetica, sans-serif\",\n    pointSize: 6,\n    legend: {\n      textStyle: {\n        fontSize: 12,\n        color: \"#444\"\n      },\n      alignment: \"center\",\n      position: \"right\"\n    },\n    curveType: \"function\",\n    hAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      gridlines: {\n        color: \"transparent\"\n      },\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    vAxis: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      },\n      titleTextStyle: {},\n      baselineColor: \"#ccc\",\n      viewWindow: {}\n    },\n    tooltip: {\n      textStyle: {\n        color: \"#666\",\n        fontSize: 12\n      }\n    }\n  };\n\n  var hideLegend$2 = function (options, legend, hideLegend) {\n    if (legend !== undefined) {\n      var position;\n      if (!legend) {\n        position = \"none\";\n      } else if (legend === true) {\n        position = \"right\";\n      } else {\n        position = legend;\n      }\n      options.legend.position = position;\n    } else if (hideLegend) {\n      options.legend.position = \"none\";\n    }\n  };\n\n  var setTitle$2 = function (options, title) {\n    options.title = title;\n    options.titleTextStyle = {color: \"#333\", fontSize: \"20px\"};\n  };\n\n  var setMin$2 = function (options, min) {\n    options.vAxis.viewWindow.min = min;\n  };\n\n  var setMax$2 = function (options, max) {\n    options.vAxis.viewWindow.max = max;\n  };\n\n  var setBarMin$1 = function (options, min) {\n    options.hAxis.viewWindow.min = min;\n  };\n\n  var setBarMax$1 = function (options, max) {\n    options.hAxis.viewWindow.max = max;\n  };\n\n  var setStacked$2 = function (options, stacked) {\n    options.isStacked = stacked ? stacked : false;\n  };\n\n  var setXtitle$2 = function (options, title) {\n    options.hAxis.title = title;\n    options.hAxis.titleTextStyle.italic = false;\n  };\n\n  var setYtitle$2 = function (options, title) {\n    options.vAxis.title = title;\n    options.vAxis.titleTextStyle.italic = false;\n  };\n\n  var jsOptions$2 = jsOptionsFunc(defaultOptions$2, hideLegend$2, setTitle$2, setMin$2, setMax$2, setStacked$2, setXtitle$2, setYtitle$2);\n\n  var resize = function (callback) {\n    if (window.attachEvent) {\n      window.attachEvent(\"onresize\", callback);\n    } else if (window.addEventListener) {\n      window.addEventListener(\"resize\", callback, true);\n    }\n    callback();\n  };\n\n  var defaultExport$2 = function defaultExport(library) {\n    this.name = \"google\";\n    this.library = library;\n  };\n\n  defaultExport$2.prototype.renderLineChart = function renderLineChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n\n      if (chart.options.curve === false) {\n        chartOptions.curveType = \"none\";\n      }\n\n      if (chart.options.points === false) {\n        chartOptions.pointSize = 0;\n      }\n\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"LineChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderPieChart = function renderPieChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        chartArea: {\n          top: \"10%\",\n          height: \"80%\"\n        },\n        legend: {}\n      };\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n      if (chart.options.donut) {\n        chartOptions.pieHole = 0.5;\n      }\n      if (\"legend\" in chart.options) {\n        hideLegend$2(chartOptions, chart.options.legend);\n      }\n      if (chart.options.title) {\n        setTitle$2(chartOptions, chart.options.title);\n      }\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", \"Value\");\n      data.addRows(chart.data);\n\n      this$1.drawChart(chart, \"PieChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderColumnChart = function renderColumnChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var options = jsOptions$2(chart, chart.options);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"ColumnChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderBarChart = function renderBarChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        hAxis: {\n          gridlines: {\n            color: \"#ccc\"\n          }\n        }\n      };\n      var options = jsOptionsFunc(defaultOptions$2, hideLegend$2, setTitle$2, setBarMin$1, setBarMax$1, setStacked$2, setXtitle$2, setYtitle$2)(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"BarChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderAreaChart = function renderAreaChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {\n        isStacked: true,\n        pointSize: 0,\n        areaOpacity: 0.5\n      };\n\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n      var data = this$1.createDataTable(chart.data, chart.xtype);\n\n      this$1.drawChart(chart, \"AreaChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderGeoChart = function renderGeoChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, \"geochart\", function () {\n      var chartOptions = {\n        legend: \"none\",\n        colorAxis: {\n          colors: chart.options.colors || [\"#f6c7b6\", \"#ce502d\"]\n        }\n      };\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"string\", \"\");\n      data.addColumn(\"number\", chart.options.label || \"Value\");\n      data.addRows(chart.data);\n\n      this$1.drawChart(chart, \"GeoChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderScatterChart = function renderScatterChart (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, function () {\n      var chartOptions = {};\n      var options = jsOptions$2(chart, chart.options, chartOptions);\n\n      var series = chart.data, rows2 = [], i, j, data, d;\n      for (i = 0; i < series.length; i++) {\n        series[i].name = series[i].name || \"Value\";\n        d = series[i].data;\n        for (j = 0; j < d.length; j++) {\n          var row = new Array(series.length + 1);\n          row[0] = d[j][0];\n          row[i + 1] = d[j][1];\n          rows2.push(row);\n        }\n      }\n\n      data = new this$1.library.visualization.DataTable();\n      data.addColumn(\"number\", \"\");\n      for (i = 0; i < series.length; i++) {\n        data.addColumn(\"number\", series[i].name);\n      }\n      data.addRows(rows2);\n\n      this$1.drawChart(chart, \"ScatterChart\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.renderTimeline = function renderTimeline (chart) {\n      var this$1 = this;\n\n    this.waitForLoaded(chart, \"timeline\", function () {\n      var chartOptions = {\n        legend: \"none\"\n      };\n\n      if (chart.options.colors) {\n        chartOptions.colors = chart.options.colors;\n      }\n      var options = merge(merge(defaultOptions$2, chartOptions), chart.options.library || {});\n\n      var data = new this$1.library.visualization.DataTable();\n      data.addColumn({type: \"string\", id: \"Name\"});\n      data.addColumn({type: \"date\", id: \"Start\"});\n      data.addColumn({type: \"date\", id: \"End\"});\n      data.addRows(chart.data);\n\n      chart.element.style.lineHeight = \"normal\";\n\n      this$1.drawChart(chart, \"Timeline\", data, options);\n    });\n  };\n\n  defaultExport$2.prototype.destroy = function destroy (chart) {\n    if (chart.chart) {\n      chart.chart.clearChart();\n    }\n  };\n\n  defaultExport$2.prototype.drawChart = function drawChart (chart, type, data, options) {\n    this.destroy(chart);\n\n    if (chart.options.code) {\n      window.console.log(\"var data = new google.visualization.DataTable(\" + data.toJSON() + \");\\nvar chart = new google.visualization.\" + type + \"(element);\\nchart.draw(data, \" + JSON.stringify(options) + \");\");\n    }\n\n    chart.chart = new this.library.visualization[type](chart.element);\n    resize(function () {\n      chart.chart.draw(data, options);\n    });\n  };\n\n  defaultExport$2.prototype.waitForLoaded = function waitForLoaded (chart, pack, callback) {\n      var this$1 = this;\n\n    if (!callback) {\n      callback = pack;\n      pack = \"corechart\";\n    }\n\n    callbacks.push({pack: pack, callback: callback});\n\n    if (loaded[pack]) {\n      this.runCallbacks();\n    } else {\n      loaded[pack] = true;\n\n      // https://groups.google.com/forum/#!topic/google-visualization-api/fMKJcyA2yyI\n      var loadOptions = {\n        packages: [pack],\n        callback: function () { this$1.runCallbacks(); }\n      };\n      var config = chart.__config();\n      if (config.language) {\n        loadOptions.language = config.language;\n      }\n      if (pack === \"geochart\" && config.mapsApiKey) {\n        loadOptions.mapsApiKey = config.mapsApiKey;\n      }\n\n      this.library.charts.load(\"current\", loadOptions);\n    }\n  };\n\n  defaultExport$2.prototype.runCallbacks = function runCallbacks () {\n    var cb, call;\n    for (var i = 0; i < callbacks.length; i++) {\n      cb = callbacks[i];\n      call = this.library.visualization && ((cb.pack === \"corechart\" && this.library.visualization.LineChart) || (cb.pack === \"timeline\" && this.library.visualization.Timeline) || (cb.pack === \"geochart\" && this.library.visualization.GeoChart));\n      if (call) {\n        cb.callback();\n        callbacks.splice(i, 1);\n        i--;\n      }\n    }\n  };\n\n  // cant use object as key\n  defaultExport$2.prototype.createDataTable = function createDataTable (series, columnType) {\n    var i, j, s, d, key, rows = [], sortedLabels = [];\n    for (i = 0; i < series.length; i++) {\n      s = series[i];\n      series[i].name = series[i].name || \"Value\";\n\n      for (j = 0; j < s.data.length; j++) {\n        d = s.data[j];\n        key = (columnType === \"datetime\") ? d[0].getTime() : d[0];\n        if (!rows[key]) {\n          rows[key] = new Array(series.length);\n          sortedLabels.push(key);\n        }\n        rows[key][i] = toFloat(d[1]);\n      }\n    }\n\n    var rows2 = [];\n    var day = true;\n    var value;\n    for (j = 0; j < sortedLabels.length; j++) {\n      i = sortedLabels[j];\n      if (columnType === \"datetime\") {\n        value = new Date(toFloat(i));\n        day = day && isDay(value);\n      } else if (columnType === \"number\") {\n        value = toFloat(i);\n      } else {\n        value = i;\n      }\n      rows2.push([value].concat(rows[i]));\n    }\n    if (columnType === \"datetime\") {\n      rows2.sort(sortByTime);\n    } else if (columnType === \"number\") {\n      rows2.sort(sortByNumberSeries);\n\n      for (i = 0; i < rows2.length; i++) {\n        rows2[i][0] = toStr(rows2[i][0]);\n      }\n\n      columnType = \"string\";\n    }\n\n    // create datatable\n    var data = new this.library.visualization.DataTable();\n    columnType = columnType === \"datetime\" && day ? \"date\" : columnType;\n    data.addColumn(columnType, \"\");\n    for (i = 0; i < series.length; i++) {\n      data.addColumn(\"number\", series[i].name);\n    }\n    data.addRows(rows2);\n\n    return data;\n  };\n\n  var pendingRequests = [], runningRequests = 0, maxRequests = 4;\n\n  function pushRequest(url, success, error) {\n    pendingRequests.push([url, success, error]);\n    runNext();\n  }\n\n  function runNext() {\n    if (runningRequests < maxRequests) {\n      var request = pendingRequests.shift();\n      if (request) {\n        runningRequests++;\n        getJSON(request[0], request[1], request[2]);\n        runNext();\n      }\n    }\n  }\n\n  function requestComplete() {\n    runningRequests--;\n    runNext();\n  }\n\n  function getJSON(url, success, error) {\n    ajaxCall(url, success, function (jqXHR, textStatus, errorThrown) {\n      var message = (typeof errorThrown === \"string\") ? errorThrown : errorThrown.message;\n      error(message);\n    });\n  }\n\n  function ajaxCall(url, success, error) {\n    var $ = window.jQuery || window.Zepto || window.$;\n\n    if ($ && $.ajax) {\n      $.ajax({\n        dataType: \"json\",\n        url: url,\n        success: success,\n        error: error,\n        complete: requestComplete\n      });\n    } else {\n      var xhr = new XMLHttpRequest();\n      xhr.open(\"GET\", url, true);\n      xhr.setRequestHeader(\"Content-Type\", \"application/json\");\n      xhr.onload = function () {\n        requestComplete();\n        if (xhr.status === 200) {\n          success(JSON.parse(xhr.responseText), xhr.statusText, xhr);\n        } else {\n          error(xhr, \"error\", xhr.statusText);\n        }\n      };\n      xhr.send();\n    }\n  }\n\n  var config = {};\n  var adapters = [];\n\n  // helpers\n\n  function setText(element, text) {\n    if (document.body.innerText) {\n      element.innerText = text;\n    } else {\n      element.textContent = text;\n    }\n  }\n\n  // TODO remove prefix for all messages\n  function chartError(element, message, noPrefix) {\n    if (!noPrefix) {\n      message = \"Error Loading Chart: \" + message;\n    }\n    setText(element, message);\n    element.style.color = \"#ff0000\";\n  }\n\n  function errorCatcher(chart) {\n    try {\n      chart.__render();\n    } catch (err) {\n      chartError(chart.element, err.message);\n      throw err;\n    }\n  }\n\n  function fetchDataSource(chart, dataSource) {\n    if (typeof dataSource === \"string\") {\n      pushRequest(dataSource, function (data) {\n        chart.rawData = data;\n        errorCatcher(chart);\n      }, function (message) {\n        chartError(chart.element, message);\n      });\n    } else if (typeof dataSource === \"function\") {\n      try {\n        dataSource(function (data) {\n          chart.rawData = data;\n          errorCatcher(chart);\n        }, function (message) {\n          chartError(chart.element, message, true);\n        });\n      } catch (err) {\n        chartError(chart.element, err, true);\n      }\n    } else {\n      chart.rawData = dataSource;\n      errorCatcher(chart);\n    }\n  }\n\n  function addDownloadButton(chart) {\n    var element = chart.element;\n    var link = document.createElement(\"a\");\n\n    var download = chart.options.download;\n    if (download === true) {\n      download = {};\n    } else if (typeof download === \"string\") {\n      download = {filename: download};\n    }\n    link.download = download.filename || \"chart.png\"; // https://caniuse.com/download\n\n    link.style.position = \"absolute\";\n    link.style.top = \"20px\";\n    link.style.right = \"20px\";\n    link.style.zIndex = 1000;\n    link.style.lineHeight = \"20px\";\n    link.target = \"_blank\"; // for safari\n    var image = document.createElement(\"img\");\n    image.alt = \"Download\";\n    image.style.border = \"none\";\n    // icon from font-awesome\n    // http://fa2png.io/\n    image.src = \"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAUCAMAAAC6V+0/AAABCFBMVEUAAADMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMzMywEsqxAAAAV3RSTlMAAQIDBggJCgsMDQ4PERQaHB0eISIjJCouLzE0OTo/QUJHSUpLTU5PUllhYmltcHh5foWLjI+SlaCio6atr7S1t7m6vsHHyM7R2tze5Obo7fHz9ff5+/1hlxK2AAAA30lEQVQYGUXBhVYCQQBA0TdYWAt2d3d3YWAHyur7/z9xgD16Lw0DW+XKx+1GgX+FRzM3HWQWrHl5N/oapW5RPe0PkBu+UYeICvozTWZVK23Ao04B79oJrOsJDOoxkZoQPWgX29pHpCZEk7rEvQYiNSFq1UMqvlCjJkRBS1R8hb00Vb/TajtBL7nTHE1X1vyMQF732dQhyF2o6SAwrzP06iUQzvwsArlnzcOdrgBhJyHa1QOgO9U1GsKuvjUTjavliZYQ8nNPapG6sap/3nrIdJ6bOWzmX/fy0XVpfzZP3S8OJT3g9EEiJwAAAABJRU5ErkJggg==\";\n    link.appendChild(image);\n    element.style.position = \"relative\";\n\n    chart.__downloadAttached = true;\n\n    // mouseenter\n    chart.__enterEvent = addEvent(element, \"mouseover\", function(e) {\n      var related = e.relatedTarget;\n      // check download option again to ensure it wasn't changed\n      if ((!related || (related !== this && !childOf(this, related))) && chart.options.download) {\n        link.href = chart.toImage(download);\n        element.appendChild(link);\n      }\n    });\n\n    // mouseleave\n    chart.__leaveEvent = addEvent(element, \"mouseout\", function(e) {\n      var related = e.relatedTarget;\n      if (!related || (related !== this && !childOf(this, related))) {\n        if (link.parentNode) {\n          link.parentNode.removeChild(link);\n        }\n      }\n    });\n  }\n\n  // https://stackoverflow.com/questions/10149963/adding-event-listener-cross-browser\n  function addEvent(elem, event, fn) {\n    if (elem.addEventListener) {\n      elem.addEventListener(event, fn, false);\n      return fn;\n    } else {\n      var fn2 = function() {\n        // set the this pointer same as addEventListener when fn is called\n        return(fn.call(elem, window.event));\n      };\n      elem.attachEvent(\"on\" + event, fn2);\n      return fn2;\n    }\n  }\n\n  function removeEvent(elem, event, fn) {\n    if (elem.removeEventListener) {\n      elem.removeEventListener(event, fn, false);\n    } else {\n      elem.detachEvent(\"on\" + event, fn);\n    }\n  }\n\n  // https://gist.github.com/shawnbot/4166283\n  function childOf(p, c) {\n    if (p === c) { return false; }\n    while (c && c !== p) { c = c.parentNode; }\n    return c === p;\n  }\n\n  function getAdapterType(library) {\n    if (library) {\n      if (library.product === \"Highcharts\") {\n        return defaultExport$1;\n      } else if (library.charts) {\n        return defaultExport$2;\n      } else if (isFunction(library)) {\n        return defaultExport;\n      }\n    }\n    throw new Error(\"Unknown adapter\");\n  }\n\n  function addAdapter(library) {\n    var adapterType = getAdapterType(library);\n    var adapter = new adapterType(library);\n\n    if (adapters.indexOf(adapter) === -1) {\n      adapters.push(adapter);\n    }\n  }\n\n  function loadAdapters() {\n    if (\"Chart\" in window) {\n      addAdapter(window.Chart);\n    }\n\n    if (\"Highcharts\" in window) {\n      addAdapter(window.Highcharts);\n    }\n\n    if (window.google && window.google.charts) {\n      addAdapter(window.google);\n    }\n  }\n\n  function dataEmpty(data, chartType) {\n    if (chartType === \"PieChart\" || chartType === \"GeoChart\" || chartType === \"Timeline\") {\n      return data.length === 0;\n    } else {\n      for (var i = 0; i < data.length; i++) {\n        if (data[i].data.length > 0) {\n          return false;\n        }\n      }\n      return true;\n    }\n  }\n\n  function renderChart(chartType, chart) {\n    if (chart.options.messages && chart.options.messages.empty && dataEmpty(chart.data, chartType)) {\n      setText(chart.element, chart.options.messages.empty);\n    } else {\n      callAdapter(chartType, chart);\n      if (chart.options.download && !chart.__downloadAttached && chart.adapter === \"chartjs\") {\n        addDownloadButton(chart);\n      }\n    }\n  }\n\n  // TODO remove chartType if cross-browser way\n  // to get the name of the chart class\n  function callAdapter(chartType, chart) {\n    var i, adapter, fnName, adapterName;\n    fnName = \"render\" + chartType;\n    adapterName = chart.options.adapter;\n\n    loadAdapters();\n\n    for (i = 0; i < adapters.length; i++) {\n      adapter = adapters[i];\n      if ((!adapterName || adapterName === adapter.name) && isFunction(adapter[fnName])) {\n        chart.adapter = adapter.name;\n        chart.__adapterObject = adapter;\n        return adapter[fnName](chart);\n      }\n    }\n\n    if (adapters.length > 0) {\n      throw new Error(\"No charting library found for \" + chartType);\n    } else {\n      throw new Error(\"No charting libraries found - be sure to include one before your charts\");\n    }\n  }\n\n  // process data\n\n  var toFormattedKey = function (key, keyType) {\n    if (keyType === \"number\") {\n      key = toFloat(key);\n    } else if (keyType === \"datetime\") {\n      key = toDate(key);\n    } else {\n      key = toStr(key);\n    }\n    return key;\n  };\n\n  var formatSeriesData = function (data, keyType) {\n    var r = [], key, j;\n    for (j = 0; j < data.length; j++) {\n      if (keyType === \"bubble\") {\n        r.push([toFloat(data[j][0]), toFloat(data[j][1]), toFloat(data[j][2])]);\n      } else {\n        key = toFormattedKey(data[j][0], keyType);\n        r.push([key, toFloat(data[j][1])]);\n      }\n    }\n    if (keyType === \"datetime\") {\n      r.sort(sortByTime);\n    } else if (keyType === \"number\") {\n      r.sort(sortByNumberSeries);\n    }\n    return r;\n  };\n\n  function detectXType(series, noDatetime, options) {\n    if (dataEmpty(series)) {\n      if ((options.xmin || options.xmax) && (!options.xmin || isDate(options.xmin)) && (!options.xmax || isDate(options.xmax))) {\n        return \"datetime\";\n      } else {\n        return \"number\";\n      }\n    } else if (detectXTypeWithFunction(series, isNumber)) {\n      return \"number\";\n    } else if (!noDatetime && detectXTypeWithFunction(series, isDate)) {\n      return \"datetime\";\n    } else {\n      return \"string\";\n    }\n  }\n\n  function detectXTypeWithFunction(series, func) {\n    var i, j, data;\n    for (i = 0; i < series.length; i++) {\n      data = toArr(series[i].data);\n      for (j = 0; j < data.length; j++) {\n        if (!func(data[j][0])) {\n          return false;\n        }\n      }\n    }\n    return true;\n  }\n\n  // creates a shallow copy of each element of the array\n  // elements are expected to be objects\n  function copySeries(series) {\n    var newSeries = [], i, j;\n    for (i = 0; i < series.length; i++) {\n      var copy = {};\n      for (j in series[i]) {\n        if (series[i].hasOwnProperty(j)) {\n          copy[j] = series[i][j];\n        }\n      }\n      newSeries.push(copy);\n    }\n    return newSeries;\n  }\n\n  function processSeries(chart, keyType, noDatetime) {\n    var i;\n\n    var opts = chart.options;\n    var series = chart.rawData;\n\n    // see if one series or multiple\n    if (!isArray(series) || typeof series[0] !== \"object\" || isArray(series[0])) {\n      series = [{name: opts.label, data: series}];\n      chart.hideLegend = true;\n    } else {\n      chart.hideLegend = false;\n    }\n\n    // convert to array\n    // must come before dataEmpty check\n    series = copySeries(series);\n    for (i = 0; i < series.length; i++) {\n      series[i].data = toArr(series[i].data);\n    }\n\n    chart.xtype = keyType ? keyType : (opts.discrete ? \"string\" : detectXType(series, noDatetime, opts));\n\n    // right format\n    for (i = 0; i < series.length; i++) {\n      series[i].data = formatSeriesData(series[i].data, chart.xtype);\n    }\n\n    return series;\n  }\n\n  function processSimple(chart) {\n    var perfectData = toArr(chart.rawData), i;\n    for (i = 0; i < perfectData.length; i++) {\n      perfectData[i] = [toStr(perfectData[i][0]), toFloat(perfectData[i][1])];\n    }\n    return perfectData;\n  }\n\n  // define classes\n\n  var Chart = function Chart(element, dataSource, options) {\n    var elementId;\n    if (typeof element === \"string\") {\n      elementId = element;\n      element = document.getElementById(element);\n      if (!element) {\n        throw new Error(\"No element with id \" + elementId);\n      }\n    }\n    this.element = element;\n    this.options = merge(Chartkick.options, options || {});\n    this.dataSource = dataSource;\n\n    Chartkick.charts[element.id] = this;\n\n    fetchDataSource(this, dataSource);\n\n    if (this.options.refresh) {\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.getElement = function getElement () {\n    return this.element;\n  };\n\n  Chart.prototype.getDataSource = function getDataSource () {\n    return this.dataSource;\n  };\n\n  Chart.prototype.getData = function getData () {\n    return this.data;\n  };\n\n  Chart.prototype.getOptions = function getOptions () {\n    return this.options;\n  };\n\n  Chart.prototype.getChartObject = function getChartObject () {\n    return this.chart;\n  };\n\n  Chart.prototype.getAdapter = function getAdapter () {\n    return this.adapter;\n  };\n\n  Chart.prototype.updateData = function updateData (dataSource, options) {\n    this.dataSource = dataSource;\n    if (options) {\n      this.__updateOptions(options);\n    }\n    fetchDataSource(this, dataSource);\n  };\n\n  Chart.prototype.setOptions = function setOptions (options) {\n    this.__updateOptions(options);\n    this.redraw();\n  };\n\n  Chart.prototype.redraw = function redraw () {\n    fetchDataSource(this, this.rawData);\n  };\n\n  Chart.prototype.refreshData = function refreshData () {\n    if (typeof this.dataSource === \"string\") {\n      // prevent browser from caching\n      var sep = this.dataSource.indexOf(\"?\") === -1 ? \"?\" : \"&\";\n      var url = this.dataSource + sep + \"_=\" + (new Date()).getTime();\n      fetchDataSource(this, url);\n    } else if (typeof this.dataSource === \"function\") {\n      fetchDataSource(this, this.dataSource);\n    }\n  };\n\n  Chart.prototype.startRefresh = function startRefresh () {\n      var this$1 = this;\n\n    var refresh = this.options.refresh;\n\n    if (refresh && typeof this.dataSource !== \"string\" && typeof this.dataSource !== \"function\") {\n      throw new Error(\"Data source must be a URL or callback for refresh\");\n    }\n\n    if (!this.intervalId) {\n      if (refresh) {\n        this.intervalId = setInterval( function () {\n          this$1.refreshData();\n        }, refresh * 1000);\n      } else {\n        throw new Error(\"No refresh interval\");\n      }\n    }\n  };\n\n  Chart.prototype.stopRefresh = function stopRefresh () {\n    if (this.intervalId) {\n      clearInterval(this.intervalId);\n      this.intervalId = null;\n    }\n  };\n\n  Chart.prototype.toImage = function toImage (download) {\n    if (this.adapter === \"chartjs\") {\n      if (download && download.background && download.background !== \"transparent\") {\n        // https://stackoverflow.com/questions/30464750/chartjs-line-chart-set-background-color\n        var canvas = this.chart.chart.canvas;\n        var ctx = this.chart.chart.ctx;\n        var tmpCanvas = document.createElement(\"canvas\");\n        var tmpCtx = tmpCanvas.getContext(\"2d\");\n        tmpCanvas.width = ctx.canvas.width;\n        tmpCanvas.height = ctx.canvas.height;\n        tmpCtx.fillStyle = download.background;\n        tmpCtx.fillRect(0, 0, tmpCanvas.width, tmpCanvas.height);\n        tmpCtx.drawImage(canvas, 0, 0);\n        return tmpCanvas.toDataURL(\"image/png\");\n      } else {\n        return this.chart.toBase64Image();\n      }\n    } else {\n      // TODO throw error in next major version\n      // throw new Error(\"Feature only available for Chart.js\");\n      return null;\n    }\n  };\n\n  Chart.prototype.destroy = function destroy () {\n    if (this.__adapterObject) {\n      this.__adapterObject.destroy(this);\n    }\n\n    if (this.__enterEvent) {\n      removeEvent(this.element, \"mouseover\", this.__enterEvent);\n    }\n\n    if (this.__leaveEvent) {\n      removeEvent(this.element, \"mouseout\", this.__leaveEvent);\n    }\n  };\n\n  Chart.prototype.__updateOptions = function __updateOptions (options) {\n    var updateRefresh = options.refresh && options.refresh !== this.options.refresh;\n    this.options = merge(Chartkick.options, options);\n    if (updateRefresh) {\n      this.stopRefresh();\n      this.startRefresh();\n    }\n  };\n\n  Chart.prototype.__render = function __render () {\n    this.data = this.__processData();\n    renderChart(this.__chartName(), this);\n  };\n\n  Chart.prototype.__config = function __config () {\n    return config;\n  };\n\n  var LineChart = /*@__PURE__*/(function (Chart) {\n    function LineChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) LineChart.__proto__ = Chart;\n    LineChart.prototype = Object.create( Chart && Chart.prototype );\n    LineChart.prototype.constructor = LineChart;\n\n    LineChart.prototype.__processData = function __processData () {\n      return processSeries(this);\n    };\n\n    LineChart.prototype.__chartName = function __chartName () {\n      return \"LineChart\";\n    };\n\n    return LineChart;\n  }(Chart));\n\n  var PieChart = /*@__PURE__*/(function (Chart) {\n    function PieChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) PieChart.__proto__ = Chart;\n    PieChart.prototype = Object.create( Chart && Chart.prototype );\n    PieChart.prototype.constructor = PieChart;\n\n    PieChart.prototype.__processData = function __processData () {\n      return processSimple(this);\n    };\n\n    PieChart.prototype.__chartName = function __chartName () {\n      return \"PieChart\";\n    };\n\n    return PieChart;\n  }(Chart));\n\n  var ColumnChart = /*@__PURE__*/(function (Chart) {\n    function ColumnChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) ColumnChart.__proto__ = Chart;\n    ColumnChart.prototype = Object.create( Chart && Chart.prototype );\n    ColumnChart.prototype.constructor = ColumnChart;\n\n    ColumnChart.prototype.__processData = function __processData () {\n      return processSeries(this, null, true);\n    };\n\n    ColumnChart.prototype.__chartName = function __chartName () {\n      return \"ColumnChart\";\n    };\n\n    return ColumnChart;\n  }(Chart));\n\n  var BarChart = /*@__PURE__*/(function (Chart) {\n    function BarChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) BarChart.__proto__ = Chart;\n    BarChart.prototype = Object.create( Chart && Chart.prototype );\n    BarChart.prototype.constructor = BarChart;\n\n    BarChart.prototype.__processData = function __processData () {\n      return processSeries(this, null, true);\n    };\n\n    BarChart.prototype.__chartName = function __chartName () {\n      return \"BarChart\";\n    };\n\n    return BarChart;\n  }(Chart));\n\n  var AreaChart = /*@__PURE__*/(function (Chart) {\n    function AreaChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) AreaChart.__proto__ = Chart;\n    AreaChart.prototype = Object.create( Chart && Chart.prototype );\n    AreaChart.prototype.constructor = AreaChart;\n\n    AreaChart.prototype.__processData = function __processData () {\n      return processSeries(this);\n    };\n\n    AreaChart.prototype.__chartName = function __chartName () {\n      return \"AreaChart\";\n    };\n\n    return AreaChart;\n  }(Chart));\n\n  var GeoChart = /*@__PURE__*/(function (Chart) {\n    function GeoChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) GeoChart.__proto__ = Chart;\n    GeoChart.prototype = Object.create( Chart && Chart.prototype );\n    GeoChart.prototype.constructor = GeoChart;\n\n    GeoChart.prototype.__processData = function __processData () {\n      return processSimple(this);\n    };\n\n    GeoChart.prototype.__chartName = function __chartName () {\n      return \"GeoChart\";\n    };\n\n    return GeoChart;\n  }(Chart));\n\n  var ScatterChart = /*@__PURE__*/(function (Chart) {\n    function ScatterChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) ScatterChart.__proto__ = Chart;\n    ScatterChart.prototype = Object.create( Chart && Chart.prototype );\n    ScatterChart.prototype.constructor = ScatterChart;\n\n    ScatterChart.prototype.__processData = function __processData () {\n      return processSeries(this, \"number\");\n    };\n\n    ScatterChart.prototype.__chartName = function __chartName () {\n      return \"ScatterChart\";\n    };\n\n    return ScatterChart;\n  }(Chart));\n\n  var BubbleChart = /*@__PURE__*/(function (Chart) {\n    function BubbleChart () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) BubbleChart.__proto__ = Chart;\n    BubbleChart.prototype = Object.create( Chart && Chart.prototype );\n    BubbleChart.prototype.constructor = BubbleChart;\n\n    BubbleChart.prototype.__processData = function __processData () {\n      return processSeries(this, \"bubble\");\n    };\n\n    BubbleChart.prototype.__chartName = function __chartName () {\n      return \"BubbleChart\";\n    };\n\n    return BubbleChart;\n  }(Chart));\n\n  var Timeline = /*@__PURE__*/(function (Chart) {\n    function Timeline () {\n      Chart.apply(this, arguments);\n    }\n\n    if ( Chart ) Timeline.__proto__ = Chart;\n    Timeline.prototype = Object.create( Chart && Chart.prototype );\n    Timeline.prototype.constructor = Timeline;\n\n    Timeline.prototype.__processData = function __processData () {\n      var i, data = this.rawData;\n      for (i = 0; i < data.length; i++) {\n        data[i][1] = toDate(data[i][1]);\n        data[i][2] = toDate(data[i][2]);\n      }\n      return data;\n    };\n\n    Timeline.prototype.__chartName = function __chartName () {\n      return \"Timeline\";\n    };\n\n    return Timeline;\n  }(Chart));\n\n  var Chartkick = {\n    LineChart: LineChart,\n    PieChart: PieChart,\n    ColumnChart: ColumnChart,\n    BarChart: BarChart,\n    AreaChart: AreaChart,\n    GeoChart: GeoChart,\n    ScatterChart: ScatterChart,\n    BubbleChart: BubbleChart,\n    Timeline: Timeline,\n    charts: {},\n    configure: function (options) {\n      for (var key in options) {\n        if (options.hasOwnProperty(key)) {\n          config[key] = options[key];\n        }\n      }\n    },\n    setDefaultOptions: function (opts) {\n      Chartkick.options = opts;\n    },\n    eachChart: function (callback) {\n      for (var chartId in Chartkick.charts) {\n        if (Chartkick.charts.hasOwnProperty(chartId)) {\n          callback(Chartkick.charts[chartId]);\n        }\n      }\n    },\n    config: config,\n    options: {},\n    adapters: adapters,\n    addAdapter: addAdapter,\n    use: function(adapter) {\n      addAdapter(adapter);\n      return Chartkick;\n    }\n  };\n\n  // not ideal, but allows for simpler integration\n  if (typeof window !== \"undefined\" && !window.Chartkick) {\n    window.Chartkick = Chartkick;\n  }\n\n  // backwards compatibility for esm require\n  Chartkick.default = Chartkick;\n\n  return Chartkick;\n\n})));\n"]},"metadata":{},"sourceType":"script"}